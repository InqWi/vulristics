{"result": "OK", "data": {"documents": {"CVE-2020-1350": {"lastseen": "2020-07-24T10:48:52", "references": ["https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-1350", "http://packetstormsecurity.com/files/158484/SIGRed-Windows-DNS-Denial-Of-Service.html"], "scheme": null, "description": "A remote code execution vulnerability exists in Windows Domain Name System servers when they fail to properly handle requests, aka 'Windows DNS Server Remote Code Execution Vulnerability'.", "edition": 4, "reporter": "cve@mitre.org", "cvss3": {}, "published": "2020-07-14T23:15:00", "title": "CVE-2020-1350", "type": "cve", "enchantments": {"dependencies": {"references": [{"type": "nessus", "idList": ["MS_DNS_CVE-2020-1350.NASL", "SMB_NT_MS20_JUL_DNS_CHECK.NASL"]}, {"type": "qualysblog", "idList": ["QUALYSBLOG:F343178EEC11B54CFAFBD0B4D505010B", "QUALYSBLOG:8028F138635C78F91B08AB2CF72FA154"]}, {"type": "impervablog", "idList": ["IMPERVABLOG:020B268DFC760B88704D35A6F4CF30D7"]}, {"type": "threatpost", "idList": ["THREATPOST:363C332F7046A481C24C7172C55CF758", "THREATPOST:7E6D2DBA11B2CCCE264B0982306FBEB1", "THREATPOST:96E775E045D4DF55CC1B9A3AA0C28F70"]}, {"type": "huawei", "idList": ["HUAWEI-SA-20200716-01-DNS"]}, {"type": "msrc", "idList": ["MSRC:79080D1EA83C3BB4689C763E5FACBDB5"]}, {"type": "thn", "idList": ["THN:DBFCCEBE2752BA05D9181D55D3477666"]}, {"type": "mscve", "idList": ["MS:CVE-2020-1350"]}, {"type": "avleonov", "idList": ["AVLEONOV:1ABE5F69187E5F9F8625DA462772F80C"]}, {"type": "krebs", "idList": ["KREBS:1A886B22AAF8ADC53874F0E126C5A96D"]}, {"type": "openvas", "idList": ["OPENVAS:1361412562310817232", "OPENVAS:1361412562310817231", "OPENVAS:1361412562310817088", "OPENVAS:1361412562310817228", "OPENVAS:1361412562310817230", "OPENVAS:1361412562310817224", "OPENVAS:1361412562310817226"]}], "modified": "2020-07-24T10:48:52", "rev": 2}, "score": {"value": 6.1, "vector": "NONE", "modified": "2020-07-24T10:48:52", "rev": 2}, "vulnersScore": 6.1}, "cwe": ["CWE-119"], "bulletinFamily": "NVD", "affectedSoftware": [{"name": "microsoft windows_server_2016", "operator": "eq", "version": "-"}, {"name": "microsoft windows_server_2012", "operator": "eq", "version": "r2"}, {"name": "microsoft windows_server_2012", "operator": "eq", "version": "-"}, {"name": "microsoft windows_server_2019", "operator": "eq", "version": "-"}, {"name": "microsoft windows_server_2008", "operator": "eq", "version": "r2"}, {"name": "microsoft windows_server_2016", "operator": "eq", "version": "1909"}, {"name": "microsoft windows_server_2008", "operator": "eq", "version": "-"}, {"name": "microsoft windows_server_2016", "operator": "eq", "version": "2004"}, {"name": "microsoft windows_server_2016", "operator": "eq", "version": "1903"}], "cvss2": {"acInsufInfo": false, "cvssV2": {"accessComplexity": "LOW", "accessVector": "NETWORK", "authentication": "NONE", "availabilityImpact": "COMPLETE", "baseScore": 10.0, "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "vectorString": "AV:N/AC:L/Au:N/C:C/I:C/A:C", "version": "2.0"}, "exploitabilityScore": 10.0, "impactScore": 10.0, "obtainAllPrivilege": false, "obtainOtherPrivilege": false, "obtainUserPrivilege": false, "severity": "HIGH", "userInteractionRequired": false}, "cvelist": ["CVE-2020-1350"], "modified": "2020-07-23T19:37:00", "cpe": ["cpe:/a:microsoft:windows_server_2016:1903", "cpe:/o:microsoft:windows_server_2019:-", "cpe:/a:microsoft:windows_server_2016:-", "cpe:/a:microsoft:windows_server_2012:r2", "cpe:/o:microsoft:windows_server_2016:2004", "cpe:/a:microsoft:windows_server_2016:2004", "cpe:/o:microsoft:windows_server_2008:-", "cpe:/a:microsoft:windows_server_2016:1909", "cpe:/o:microsoft:windows_server_2012:r2", "cpe:/a:microsoft:windows_server_2008:-", "cpe:/o:microsoft:windows_server_2016:1909", "cpe:/o:microsoft:windows_server_2012:-", "cpe:/o:microsoft:windows_server_2008:r2", "cpe:/a:microsoft:windows_server_2019:-", "cpe:/a:microsoft:windows_server_2012:-", "cpe:/a:microsoft:windows_server_2008:r2", "cpe:/o:microsoft:windows_server_2016:-", "cpe:/o:microsoft:windows_server_2016:1903"], "id": "CVE-2020-1350", "href": "https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2020-1350", "viewCount": 66, "cvss": {"score": 10.0, "vector": "AV:N/AC:L/Au:N/C:C/I:C/A:C"}, "cpe23": ["cpe:2.3:o:microsoft:windows_server_2019:-:*:*:*:*:*:*:*", "cpe:2.3:o:microsoft:windows_server_2016:1903:*:*:*:*:*:*:*", "cpe:2.3:o:microsoft:windows_server_2012:-:*:*:*:*:*:*:*", "cpe:2.3:o:microsoft:windows_server_2012:r2:*:*:*:*:*:*:*", "cpe:2.3:o:microsoft:windows_server_2016:-:*:*:*:*:*:*:*", "cpe:2.3:o:microsoft:windows_server_2016:2004:*:*:*:*:*:*:*", "cpe:2.3:o:microsoft:windows_server_2008:-:sp2:*:*:*:*:*:*", "cpe:2.3:o:microsoft:windows_server_2008:r2:sp1:*:*:*:*:x64:*", "cpe:2.3:o:microsoft:windows_server_2016:1909:*:*:*:*:*:*:*"]}}, "references": {"CVE-2020-1350": {"nessus": [{"lastseen": "2020-07-22T04:50:16", "bulletinFamily": "scanner", "description": "The remote Windows host is missing a security update. It is, \ntherefore, affected by a remote code execution vulnerability:\n\n  - A remote code execution vulnerability exists in Windows\n    Domain Name System servers when they fail to properly\n    handle requests. An attacker who successfully exploited\n    the vulnerability could run arbitrary code in the\n    context of the Local System Account. Windows servers\n    that are configured as DNS servers are at risk from this\n    vulnerability.  (CVE-2020-1350)", "modified": "2020-07-17T00:00:00", "id": "SMB_NT_MS20_JUL_DNS_CHECK.NASL", "href": "https://www.tenable.com/plugins/nessus/138600", "published": "2020-07-17T00:00:00", "title": "Windows DNS Server RCE (CVE-2020-1350)", "type": "nessus", "sourceData": "#\n# (C) Tenable Network Security, Inc.\n#\n# The descriptive text and package checks in this plugin were  \n# extracted from the Microsoft Security Updates API. The text\n# itself is copyright (C) Microsoft Corporation.\n#\n\ninclude('compat.inc');\n\nif (description)\n{\n  script_id(138600);\n  script_version(\"1.3\");\n  script_set_attribute(attribute:\"plugin_modification_date\", value:\"2020/07/21\");\n\n  script_cve_id(\"CVE-2020-1350\");\n  script_xref(name:\"MSKB\", value:\"4558998\");\n  script_xref(name:\"MSKB\", value:\"4565483\");\n  script_xref(name:\"MSKB\", value:\"4565483\");\n  script_xref(name:\"MSKB\", value:\"4565503\");\n  script_xref(name:\"MSKB\", value:\"4565511\");\n  script_xref(name:\"MSKB\", value:\"4565524\");\n  script_xref(name:\"MSKB\", value:\"4565529\");\n  script_xref(name:\"MSKB\", value:\"4565535\");\n  script_xref(name:\"MSKB\", value:\"4565536\");\n  script_xref(name:\"MSKB\", value:\"4565537\");\n  script_xref(name:\"MSKB\", value:\"4565539\");\n  script_xref(name:\"MSKB\", value:\"4565540\");\n  script_xref(name:\"MSKB\", value:\"4565541\");\n  script_xref(name:\"MSFT\", value:\"MS20-4558998\");\n  script_xref(name:\"MSFT\", value:\"MS20-4565483\");\n  script_xref(name:\"MSFT\", value:\"MS20-4565483\");\n  script_xref(name:\"MSFT\", value:\"MS20-4565503\");\n  script_xref(name:\"MSFT\", value:\"MS20-4565511\");\n  script_xref(name:\"MSFT\", value:\"MS20-4565524\");\n  script_xref(name:\"MSFT\", value:\"MS20-4565529\");\n  script_xref(name:\"MSFT\", value:\"MS20-4565535\");\n  script_xref(name:\"MSFT\", value:\"MS20-4565536\");\n  script_xref(name:\"MSFT\", value:\"MS20-4565537\");\n  script_xref(name:\"MSFT\", value:\"MS20-4565539\");\n  script_xref(name:\"MSFT\", value:\"MS20-4565540\");\n  script_xref(name:\"MSFT\", value:\"MS20-4565541\");\n  script_xref(name:\"IAVA\", value:\"2020-A-0299\");\n\n  script_name(english:\"Windows DNS Server RCE (CVE-2020-1350)\");\n\n  script_set_attribute(attribute:\"synopsis\", value:\n\"The remote Windows host is affected by multiple vulnerabilities.\");\n  script_set_attribute(attribute:\"description\", value:\n\"The remote Windows host is missing a security update. It is, \ntherefore, affected by a remote code execution vulnerability:\n\n  - A remote code execution vulnerability exists in Windows\n    Domain Name System servers when they fail to properly\n    handle requests. An attacker who successfully exploited\n    the vulnerability could run arbitrary code in the\n    context of the Local System Account. Windows servers\n    that are configured as DNS servers are at risk from this\n    vulnerability.  (CVE-2020-1350)\");\n  # https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-1350\n  script_set_attribute(attribute:\"see_also\", value:\"http://www.nessus.org/u?6a916fa9\");\n  script_set_attribute(attribute:\"solution\", value:\n\"Apply the appropriate security update or mitigation as described in the Microsoft advisory.\");\n  script_set_cvss_base_vector(\"CVSS2#AV:N/AC:L/Au:N/C:C/I:C/A:C\");\n  script_set_cvss_temporal_vector(\"CVSS2#E:U/RL:OF/RC:C\");\n  script_set_cvss3_base_vector(\"CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H\");\n  script_set_cvss3_temporal_vector(\"CVSS:3.0/E:U/RL:O/RC:C\");\n  script_set_attribute(attribute:\"cvss_score_source\", value:\"CVE-2020-1350\");\n\n  script_set_attribute(attribute:\"exploitability_ease\", value:\"No known exploits are available\");\n\n  script_set_attribute(attribute:\"vuln_publication_date\", value:\"2020/07/14\");\n  script_set_attribute(attribute:\"patch_publication_date\", value:\"2020/07/14\");\n  script_set_attribute(attribute:\"plugin_publication_date\", value:\"2020/07/17\");\n\n  script_set_attribute(attribute:\"plugin_type\", value:\"local\");\n  script_set_attribute(attribute:\"cpe\", value:\"cpe:/o:microsoft:windows\");\n  script_set_attribute(attribute:\"stig_severity\", value:\"I\");\n  script_end_attributes();\n\n  script_category(ACT_GATHER_INFO);\n  script_family(english:\"Windows : Microsoft Bulletins\");\n\n  script_copyright(english:\"This script is Copyright (C) 2020 and is owned by Tenable, Inc. or an Affiliate thereof.\");\n\n  script_dependencies(\"smb_check_rollup.nasl\", \"smb_hotfixes.nasl\", \"ms_bulletin_checks_possible.nasl\", \"wmi_enum_server_features.nbin\");\n  script_require_keys(\"SMB/MS_Bulletin_Checks/Possible\", \"SMB/WMI/Available\");\n  script_require_ports(139, 445, \"Host/patch_management_checks\");\n\n  exit(0);\n}\n\ninclude('smb_hotfixes_fcheck.inc');\ninclude('smb_hotfixes.inc');\ninclude('smb_func.inc');\n\n\nfunction is_dns_server()\n{\n  local_var server_features, feature;\n  server_features = get_kb_list(\"WMI/server_feature/*\");\n  foreach (feature in server_features)\n  {\n    if ('DNS Server' == feature) return 1;\n  }\n  return 0;\n}\n\nget_kb_item_or_exit('SMB/MS_Bulletin_Checks/Possible');\n\nbulletin = 'MS20-07';\n\nget_kb_item_or_exit('SMB/Registry/Enumerated');\nmy_os = get_kb_item_or_exit('SMB/WindowsVersion', exit_code:1);\nmy_os_build = get_kb_item('SMB/WindowsVersionBuild');\nmy_prod = get_kb_item_or_exit('SMB/ProductName');\nsp = 0;\nvuln = FALSE;\nmitigated = FALSE;\n\nif (hotfix_check_sp_range(vista:'2', win7:'1', win8:'0',  win81:'0', win10:'0') <= 0) audit(AUDIT_OS_SP_NOT_VULN);\n\n## Set kbs and sp\nif(my_os == '6.0' && 'server' >< tolower(my_prod))\n{\n  kbs = make_list('4565536','4565529');\n  sp = 2;\n}\nelse if(my_os == '6.1' && 'server' >< tolower(my_prod))\n{\n  kbs = make_list('4565524','4565539');\n  sp = 1;\n}\nelse if(my_os == '6.2' && 'server' >< tolower(my_prod))\n{\n  kbs = make_list('4565537','4565535');\n}\nelse if(my_os == '6.3' && 'server' >< tolower(my_prod))\n{\n  kbs = make_list('4565541','4565540');\n}\nelse if(my_os == '10' && 'server' >< tolower(my_prod))\n{\n    if(my_os_build == '14393') kbs = make_list('4565511');\n    else if(my_os_build == '17763') kbs = make_list('4558998');\n    else if(my_os_build == '18362') kbs = make_list('4565483');\n    else if(my_os_build == '18363') kbs = make_list('4565483');\n    else if(my_os_build == '19041') kbs = make_list('4565503');\n}\nelse\n    audit(AUDIT_OS_SP_NOT_VULN);\n\nshare = hotfix_get_systemdrive(as_share:TRUE, exit_on_fail:TRUE);\nif (!is_accessible_share(share:share)) audit(AUDIT_SHARE_FAIL, share);\n\nif ( my_os == '10' )\n{   \n  vuln = smb_check_rollup( os:'10',\n                           sp:0,\n                           os_build:my_os_build,\n                           rollup_date:'07_2020',\n                           bulletin:bulletin,\n                           rollup_kb_list:kbs\n                        );\n}\nelse\n{\n  vuln = smb_check_rollup( os:my_os, \n                           sp:sp,\n                           rollup_date:'07_2020',\n                           bulletin:bulletin,\n                           rollup_kb_list:kbs\n                        );\n}\n\n## Check mitigation\nmitigation_key = 'SYSTEM\\\\CurrentControlSet\\\\Services\\\\DNS\\\\Parameters\\\\TcpReceivePacketSize';\nregistry_init();\nhklm = registry_hive_connect(hive:HKEY_LOCAL_MACHINE, exit_on_fail:TRUE);\npacketsize = get_registry_value(handle:hklm, item:mitigation_key);\nRegCloseKey(handle:hklm);\nclose_registry(close:TRUE);\n\nif (!isnull(packetsize) && (packetsize == 65280))\n    mitigated = TRUE;\n\nif(vuln && is_dns_server() && !mitigated)\n{\n  replace_kb_item(name:'SMB/Missing/'+bulletin, value:TRUE);\n  hotfix_security_hole();\n  hotfix_check_fversion_end();\n  exit(0);\n}\nelse\n{\n  hotfix_check_fversion_end();\n  audit(AUDIT_HOST_NOT, hotfix_get_audit_report());\n}\n", "cvss": {"score": 10.0, "vector": "AV:N/AC:L/Au:N/C:C/I:C/A:C"}}, {"lastseen": "2020-07-19T19:31:57", "bulletinFamily": "scanner", "description": "According to its self-reported version number, the Microsoft DNS\nServer running on the remote host is affected by a remote code\nexecution vulnerability. An unauthenticated, remote attacker who\nsuccessfully exploited the vulnerability could run arbitrary code in\nthe context of the Local System Account.\n\nNote that in order to get the full Microsoft DNS server version, the\nEnableVersionQuery DNS setting would need to be set to 1.", "modified": "2020-07-16T00:00:00", "id": "MS_DNS_CVE-2020-1350.NASL", "href": "https://www.tenable.com/plugins/nessus/138554", "published": "2020-07-16T00:00:00", "title": "Microsoft DNS Server Remote Code Execution (SIGRed)", "type": "nessus", "sourceData": "#\n# (C) Tenable Network Security, Inc.\n#\n\ninclude('compat.inc');\n\nif (description)\n{\n  script_id(138554);\n  script_version(\"1.2\");\n  script_set_attribute(attribute:\"plugin_modification_date\", value:\"2020/07/17\");\n\n  script_cve_id(\"CVE-2020-1350\");\n  script_xref(name:\"IAVA\", value:\"2020-A-0299\");\n  script_xref(name:\"MSKB\", value:\"4558998\");\n  script_xref(name:\"MSKB\", value:\"4565483\");\n  script_xref(name:\"MSKB\", value:\"4565503\");\n  script_xref(name:\"MSKB\", value:\"4565511\");\n  script_xref(name:\"MSKB\", value:\"4565524\");\n  script_xref(name:\"MSKB\", value:\"4565529\");\n  script_xref(name:\"MSKB\", value:\"4565535\");\n  script_xref(name:\"MSKB\", value:\"4565536\");\n  script_xref(name:\"MSKB\", value:\"4565537\");\n  script_xref(name:\"MSKB\", value:\"4565539\");\n  script_xref(name:\"MSKB\", value:\"4565540\");\n  script_xref(name:\"MSKB\", value:\"4565541\");\n  script_xref(name:\"MSFT\", value:\"MS20-4558998\");\n  script_xref(name:\"MSFT\", value:\"MS20-4565483\");\n  script_xref(name:\"MSFT\", value:\"MS20-4565503\");\n  script_xref(name:\"MSFT\", value:\"MS20-4565511\");\n  script_xref(name:\"MSFT\", value:\"MS20-4565524\");\n  script_xref(name:\"MSFT\", value:\"MS20-4565529\");\n  script_xref(name:\"MSFT\", value:\"MS20-4565535\");\n  script_xref(name:\"MSFT\", value:\"MS20-4565536\");\n  script_xref(name:\"MSFT\", value:\"MS20-4565537\");\n  script_xref(name:\"MSFT\", value:\"MS20-4565539\");\n  script_xref(name:\"MSFT\", value:\"MS20-4565540\");\n  script_xref(name:\"MSFT\", value:\"MS20-4565541\");\n\n  script_name(english:\"Microsoft DNS Server Remote Code Execution (SIGRed)\");\n  script_summary(english:\"Checks version of Microsoft DNS Server\");\n\n  script_set_attribute(attribute:\"synopsis\", value:\n\"The DNS server running on the remote host is affected by a\nremote code execution vulnerability.\");\n  script_set_attribute(attribute:\"description\", value:\n\"According to its self-reported version number, the Microsoft DNS\nServer running on the remote host is affected by a remote code\nexecution vulnerability. An unauthenticated, remote attacker who\nsuccessfully exploited the vulnerability could run arbitrary code in\nthe context of the Local System Account.\n\nNote that in order to get the full Microsoft DNS server version, the\nEnableVersionQuery DNS setting would need to be set to 1.\");\n  # https://research.checkpoint.com/2020/resolving-your-way-into-domain-admin-exploiting-a-17-year-old-bug-in-windows-dns-servers/\n  script_set_attribute(attribute:\"see_also\", value:\"http://www.nessus.org/u?22a53c13\");\n  script_set_attribute(attribute:\"solution\", value:\n\"Microsoft has released a set of patches for Windows Server 2008, 2008 R2, 2012, 2012 R2, 2016, 2019, version 1903, 1909, and 2004.\");\n  script_set_cvss_base_vector(\"CVSS2#AV:N/AC:L/Au:N/C:C/I:C/A:C\");\n  script_set_cvss_temporal_vector(\"CVSS2#E:U/RL:OF/RC:C\");\n  script_set_cvss3_base_vector(\"CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H\");\n  script_set_cvss3_temporal_vector(\"CVSS:3.0/E:U/RL:O/RC:C\");\n  script_set_attribute(attribute:\"cvss_score_source\", value:\"CVE-2020-1350\");\n\n  script_set_attribute(attribute:\"exploitability_ease\", value:\"No known exploits are available\");\n\n  script_set_attribute(attribute:\"vuln_publication_date\", value:\"2020/07/14\");\n  script_set_attribute(attribute:\"patch_publication_date\", value:\"2020/07/14\");\n  script_set_attribute(attribute:\"plugin_publication_date\", value:\"2020/07/16\");\n\n  script_set_attribute(attribute:\"plugin_type\", value:\"remote\");\n  script_set_attribute(attribute:\"cpe\", value:\"cpe:/o:microsoft:windows\");\n  script_set_attribute(attribute:\"stig_severity\", value:\"I\");\n  script_end_attributes();\n\n  script_category(ACT_GATHER_INFO);\n  script_family(english:\"DNS\");\n\n  script_copyright(english:\"This script is Copyright (C) 2020 and is owned by Tenable, Inc. or an Affiliate thereof.\");\n\n  script_dependencies(\"ms_dns_version.nasl\");\n  script_require_keys(\"ms_dns/version\");\n\n  exit(0);\n}\n\ninclude('vcf.inc');\n\nkb_ver = 'ms_dns/version';\nversion = get_kb_item_or_exit(kb_ver);\nport = 53;\n\napp_info = vcf::get_app_info(app:'Microsoft DNS server', kb_ver:kb_ver, port:port);\n\nvcf::check_granularity(app_info:app_info, sig_segments:4);\n\nconstraints = [\n  # Windows Server 2008\n  { 'min_version': '6.0.6003.0', 'fixed_version': '6.0.6003.20885' },\n\n  # Windows Server 2008 R2\n  { 'min_version': '6.1.7601.0', 'fixed_version': '6.1.7601.24557' },\n\n  # Windows Sever 2012\n  { 'min_version': '6.2.9200.0', 'fixed_version': '6.2.9200.23084' },\n\n  # Windows Sever 2012 R2\n  { 'min_version': '6.3.9600.0', 'fixed_version': '6.3.9600.19759' },\n  \n  # Windows Server 2016\n  { 'min_version': '10.0.14393.0', 'fixed_version': '10.0.14393.3808' },\n\n  # Windows Server 2019\n  { 'min_version': '10.0.17763.0', 'fixed_version': '10.0.17763.1339' },\n\n  # Windows Server, version 1903/1909\n  # 1903 and 1909 have the same KB\n  { 'min_version': '10.0.18362.0', 'fixed_version': '10.0.18362.959' },\n\n  # Windows Server, version 2004\n  { 'min_version': '10.0.19041.0', 'fixed_version': '10.0.19041.388' }\n\n];\n\nvcf::check_version_and_report(app_info:app_info, constraints:constraints, severity:SECURITY_HOLE);\n", "cvss": {"score": 10.0, "vector": "AV:N/AC:L/Au:N/C:C/I:C/A:C"}}], "qualysblog": [{"lastseen": "2020-07-21T18:02:09", "bulletinFamily": "blog", "description": "On July 14, 2020, Microsoft issued a new security advisory on [Microsoft Windows Patch Day](<https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-1350>) \u2013 addressing **CVE-2020-1350, **also known as **SigRed** \u2013 a remote code execution vulnerability in Windows Domain Name System (DNS) servers. The security issue has received a critical severity rating score of 10.0 based on CVSS v3.1 Scoring system. \n\n**SigRed** affects Windows servers that are configured to run the DNS Server role as described in the advisory.\n\n#### **The Vulnerability**\n\nMicrosoft mentioned that \u201cit found no evidence to show that the bug has been actively exploited by attackers and advised users to install patches immediately.\u201d Furthermore, it added that the vulnerability has the potential to spread via malware between vulnerable computers without any user interaction. No authentication is mandatory to execute this wormable vulnerability. A nefarious actor who is successful in exploiting this vulnerability could run arbitrary code in the Local System account.\n\nThe flaw impacts only Windows DNS servers and not DNS server clients. Check Point Research team members Sagi Tzadik and Eyal Itkin have presented their research to Microsoft and shown it in a video [here](<https://www.youtube.com/watch?v=PUlMmhD5it8>).\n\nThe following components are vulnerable to CVE-2020-1350:\n\nFunction: _dns.exe!SigWireRead_\n\nVulnerability Type: _Integer Overflow leading to Heap-Based Buffer Overflow_\n\n![](https://threatprotect.qualys.com/wp-content/uploads/2020/07/2020-1320.jpg)\n\nImage Source: [Check Point](<https://www.youtube.com/watch?v=PUlMmhD5it8>)\n\n\u201cWithout any human interaction or authentication, a single exploit can start a chain reaction that would allow attacks to spread from one vulnerable machine to another,\u201d the researcher said. \u201cThis means that a single compromised machine could spread this attack throughout an organization\u2019s network within minutes of the first exploit.\u201d\n\n**Affected Windows Products**\n\nWindows Server 2004, Windows Server 2008, Windows Server 2012, Windows Server 2016, Windows Server 2019\n\n### Identify Assets, Discover, Prioritize and Remediate Using Qualys VMDR\u00ae\n\nQualys VMDR, all-in-one vulnerability management, detection and response enables:  \n\n  * Identification of known and unknown hosts running vulnerable Windows servers with DNS service\n  * Automatic detection of vulnerabilities and misconfigurations for Windows servers\n  * Prioritization of threats based on risk \n  * Integrated patch deployment \n\n#### Identification of Windows Assets with DNS Running\n\nThe first step in managing vulnerabilities and reducing risk is identification of assets. VMDR enables easy identification of windows server hosts with DNS service running\n\n_operatingSystem.category1:`Windows` and services.name:`DNS` _\n\n![](https://blog.qualys.com/wp-content/uploads/2020/07/Screen-Shot-2020-07-20-at-12.43.50-PM-1-1070x418.png)\n\nOnce the hosts are identified, they can be grouped together with a \u2018dynamic tag\u2019, let\u2019s say \u2013 SIGRED. This helps in automatically grouping existing Windows hosts SIGRED as well as any new host that spins up with this vulnerability. Tagging makes these grouped assets available for querying, reporting and management throughout the [Qualys Cloud Platform](<https://www.qualys.com/cloud-platform/>). \n\n#### Discover SIGRED CVE-2020-1350 Vulnerability and Misconfigurations \n\nNow that the windows hosts with SIGRED are identified, you want to detect which of these assets have flagged this vulnerability. VMDR automatically detects new vulnerabilities like SIGRED based on the always-updated Knowledgebase.\n\nYou can see all your impacted hosts for this vulnerability tagged with the \u2018SIGRED\u2019 asset tag in the vulnerabilities view by using QQL query:\n\n_vulnerabilities.vulnerability.qid: 916_62\n\nThis will return a list of all impacted hosts.\n\n![](https://blog.qualys.com/wp-content/uploads/2020/07/Screen-Shot-2020-07-20-at-12.21.05-PM-1070x192.png)\n\nAlong with the QID 91662, Qualys released the following IG QID 45451 to help customers track assets on which they have the mitigation applied. This QID can be detected using authenticated scanning or the [Qualys Cloud Agent](<https://www.qualys.com/cloud-agent/>).\n\n_QID 45451: Microsoft KB4569509 Mitigation Guidance for DNS Server Applied (CVE-2020-1350). _\n\nThese QIDs are included in signature version VULNSIGS-2.4.942-2 and above.\n\nUsing VMDR, QID 91662 can be prioritized for the following RTIs:\n\n  * Remote Code Execution\n  * Unauthenticated Exploitation\n  * Public Exploit\n  * Denial of Service\n  * Easy Exploit\n  * High Data Loss\n  * Wormable\n  * Predicted High Risk\n  * Privilege Escalation\n  * High Lateral Movement\n![](https://blog.qualys.com/wp-content/uploads/2020/07/Screen-Shot-2020-07-20-at-12.20.16-PM-2-1070x522.png)\n\nVMDR also enables you to stay on top of these threats proactively via the \u2018live feed\u2019 provided for threat prioritization. With \u2018live feed\u2019 updated for all emerging high and medium risks, you can clearly see the impacted hosts against threats.  \n\n![](https://blog.qualys.com/wp-content/uploads/2020/07/Screen-Shot-2020-07-20-at-12.46.51-PM-1070x667.png)\n\nSimply click on the impacted assets for the SIGRED threat feed to see the vulnerability and impacted host details. \n\nWith VM Dashboard, you can track SIGRED, impacted hosts, their status and overall management in real-time. With trending enabled for dashboard widgets, you can keep track of SIGRED vulnerability trends in your environment using [Microsoft SIGRED RCE Vulnerability Dashboard](<https://qualys-secure.force.com/customers/articles/Knowledge/000006377>).\n\n![](https://blog.qualys.com/wp-content/uploads/2020/07/Screen-Shot-2020-07-15-at-1.34.59-PM-1070x915.png)\n\n**Configuration management adds context to overall vulnerability management**\n\nTo reduce the overall security risk, it is important to take care of Windows system misconfigurations as well. Qualys VMDR shows your Windows system misconfiguration posture in context with your vulnerability posture, allowing you to see which hosts have SIGRED RCE vulnerability.  \n\nWith the [Qualys Policy Compliance](<https://community.qualys.com/policy-compliance/>) module of VMDR, you can automatically discover the status of the \u2018DNS\u2019 service and if they have misconfigurations in context to the SIGRED vulnerability. \n\n  * Qualys configuration ID \u2013 18935 \"Status of the 'TcpReceivePacketSize' parameter within the 'HKLM\\System\\CurrentControlSet\\Services\\DNS\\Parameters' registry key\" would be evaluated against all Windows DNS servers as shown below\n![](https://blog.qualys.com/wp-content/uploads/2020/07/18935-Pass-1-1070x354.png)\n\n#### Risk-Based Prioritization of SIGRED RCE Vulnerability \n\nNow that you have identified the hosts, versions and context of detected vulnerabilities and misconfigurations, you may want to prioritize your remediation based on the risk, as each vulnerable asset might not pose the same risk.  \n\n**High Risk: ** \n\n  * Hosts with DNS enabled and patch or workaround not applied are at high risk. \n  * If due to business reasons it is not possible to apply the patch on the hosts for which CVE-2020-1350 is detected. Customers can check for misconfigurations (CID 18935 controls are failing) as shown below. \n![](https://blog.qualys.com/wp-content/uploads/2020/07/18935-Fail-1070x353.png)\n\n**Medium Risk:** \n\n  * Hosts with DNS enabled for which CVE-2020-1350 is detected, however, the configuration 18935 is detected as hardened are at medium risk.\n\n### Response by Patching and Remediation \n\nVMDR rapidly remediates the Windows hosts by deploying the most relevant and applicable per-technology version patches. You can simply select \u201ccve:`CVE-2020-1350`\u201d in the Patch Catalog and filter on the \u201cMissing\u201d patches to identify and deploy the applicable, available patches in one go for hosts grouped together by a tag \u2013 SIGRED. \n\nFor proactive, continuous patching, you can create a daily job with a 24-hour \u201cPatch Window\u201d to ensure all hosts will continue to receive the required patches as new patches become available for emerging vulnerabilities. \n\nUsers are encouraged to apply patches as soon as possible.\n\n![](https://blog.qualys.com/wp-content/uploads/2020/07/Screen-Shot-2020-07-20-at-12.52.47-PM-1070x675.png)\n\nIn cases where due to business reasons it is not possible to apply patches, it is recommended that you reduce your security risk by remediating the related configuration settings for all running DNS Windows servers as provided in [Qualys Policy Compliance](<https://community.qualys.com/policy-compliance/>) by applying the following workarounds:\n\n**Workarounds**\n\nRegistry modification\n\n_HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\DNS\\Parameters_\n\n_DWORD = TcpReceivePacketSize_\n\n_Value = 0xFF00_\n\nNote: You must restart the DNS Service for the workaround to take effect.\n\n### Get Started Now\n\nStart your [Qualys VMDR trial](<https://www.qualys.com/subscriptions/vmdr/>) for automatically identifying, detecting and patching critical SIGRED RCE vulnerability CVE-2020-1350.", "modified": "2020-07-20T20:45:55", "published": "2020-07-20T20:45:55", "id": "QUALYSBLOG:8028F138635C78F91B08AB2CF72FA154", "href": "https://blog.qualys.com/category/vulnerabilities-research", "type": "qualysblog", "title": "Automatically Discover, Prioritize and Remediate Windows DNS Vulnerability (SigRed \u2013 CVE-2020-1350) Using Qualys VMDR\u00ae", "cvss": {"score": 10.0, "vector": "AV:N/AC:L/Au:N/C:C/I:C/A:C"}}, {"lastseen": "2020-07-16T10:01:24", "bulletinFamily": "blog", "description": "This month\u2019s Microsoft Patch Tuesday addresses 123 vulnerabilities with 18 of them labeled as Critical. The 18 Critical vulnerabilities cover Hyper-V, DNS Server, PerformancePoint, SharePoint Server, Office, Outlook, Remote Desktop, and several other workstation vulnerabilities. Adobe issued patches today for Download Manager, Media Encoder, Genuine Service, ColdFusion, and Creative Cloud.\n\n## Workstation Patches\n\nToday's patch Tuesday fixes many vulnerabilities that would impact workstations. The Office, Outlook, Remote Desktop Client, DirectWrite, Address Book, LNK, GDI+, Font Library, and VBScript vulnerabilities should be prioritized for workstation-type devices, meaning any system that is used for email or to access the internet via a browser. This includes multi-user servers that are used as remote desktops for users.\n\n## Windows DNS Server RCE\n\nAn extremely critical Remote Code Execution vulnerability ([CVE-2020-1350](<https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-1350>)) is fixed today in all versions of Windows DNS Server. Microsoft ranks this vulnerability as \"Exploitation More Likely,\" and according to Microsoft and the researchers at [Check Point](<https://research.checkpoint.com/>), the vulnerability is wormable. It is highly recommended to prioritize these patches on all Microsoft DNS servers, including Active Directory servers.\n\nIn a [guidance document](<https://support.microsoft.com/en-us/help/4569509/windows-dns-server-remote-code-execution-vulnerability>), Microsoft provides a workaround that involves setting the maximum TcpReceivePacketSize to prevent exploitation. If patches cannot be deployed immediately, this workaround should be considered.\n\n## Hyper-V RemoteFX vGPU RCE\n\nMicrosoft patched six similar RCE vulnerabilities ([CVE-2020-1032](<https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-1032>), [CVE-2020-1036](<https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-1036>), [CVE-2020-1040](<https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-1040>), [CVE-2020-1041](<https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-1041>), [CVE-2020-1042](<https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-1042>), [CVE-2020-1043](<https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-1043>)) related to the way graphics drivers are handled in Hyper-V. Since the vulnerabilities involve directly attacking the host's graphics drivers, this patch simply disables RemoteFX functionality. According to Microsoft: \"RemoteFX vGPU has been deprecated in Windows Server 2019 and customers are advised to use Discrete Device Assignment (DDA) instead of RemoteFX vGPU. DDA was introduced in Windows Server 2016.\"\n\n## Deserialization RCEs in PerformancePoint Services, SharePoint, .NET, and Visual Studio\n\nMicrosoft also patched two RCEs in PerformancePoint Services for SharePoint Server ([CVE-2020-1439](<https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-1439>)) along with .NET Framework, SharePoint Server, and Visual Studio ([CVE-2020-1147](<https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-1147>)). These vulnerabilities both involve the deserialization of XML content and could lead to Remote Code Execution if exploited.\n\n## Adobe\n\nAdobe issued patches today covering multiple vulnerabilities in [Download Manager](<https://helpx.adobe.com/security/products/adm/apsb20-49.html>), [Media Encoder](<https://helpx.adobe.com/security/products/media-encoder/apsb20-36.html>), [Genuine Service](<https://helpx.adobe.com/security/products/integrity_service/apsb20-42.html>), [ColdFusion](<https://helpx.adobe.com/security/products/coldfusion/apsb20-43.html>), and [Creative Cloud](<https://helpx.adobe.com/security/products/creative-cloud/apsb20-33.html>). The patches for Creative Cloud and ColdFusion are labeled as [Priority 2](<https://helpx.adobe.com/security/severity-ratings.html>), while the remaining patches are set to [Priority 3](<https://helpx.adobe.com/security/severity-ratings.html>).\n\nWhile none of the vulnerabilities disclosed in Adobe\u2019s release are known to be Actively Attacked today, all patches should be prioritized on systems with these products installed.\n\n## About Patch Tuesday\n\nPatch Tuesday QIDs are published at [Security Alerts](<https://www.qualys.com/research/security-alerts/>), typically late in the evening of [Patch Tuesday](<https://blog.qualys.com/tag/patch-tuesday>).", "modified": "2020-07-14T18:58:08", "published": "2020-07-14T18:58:08", "id": "QUALYSBLOG:F343178EEC11B54CFAFBD0B4D505010B", "href": "https://blog.qualys.com/category/vulnerabilities-research", "type": "qualysblog", "title": "July 2020 Patch Tuesday \u2013 123 Vulnerabilities, 18 Critical, Hyper-V RemoteFX, DNS Server, Workstation, Adobe", "cvss": {"score": 10.0, "vector": "AV:N/AC:L/Au:N/C:C/I:C/A:C"}}], "impervablog": [{"lastseen": "2020-07-21T16:02:08", "bulletinFamily": "blog", "description": "Recently, [Check Point researchers](<https://research.checkpoint.com/2020/resolving-your-way-into-domain-admin:-exploiting-a-17-year-old-bug-in-windows-dns-servers/>) found a 17-year-old high-profile flaw, SIGRed (CVE-2020-1350). The flaw is a wormable, critical vulnerability in the Windows DNS server, and can be triggered by a malicious DNS response.\n\nOn a zero to 10 scale, this vulnerability has received a CVSS base score of 10 in terms of how easy it is to exploit and how damaging it can be. Successful exploitation could lead to a critical RCE on Windows DNS servers due to the improper handling of DNS requests - effectively compromising the entire corporate infrastructure.\n\nFortunately, Imperva [DDoS Protection for Domain Name Servers (DNS)](<https://www.imperva.com/products/dns-ddos-protection-services/>) can shield against this vulnerability and ensure the attack is not forwarded to the origin name server. Customers using our protected DNS service are safe provided that their DNS server accepts incoming requests from Imperva\u2019s proxies only (this configuration should be done in the onboarding process); thus, they should block incoming requests from other IPs and block requests that are not for this domain.\n\n## **How do we protect against this vulnerability? **\n\nThe Imperva service checks the requested DNS name and forwards the request to the origin (authoritative DNS server) only if the name matches the authoritative domain name.\n\nFor example: If our protected DNS customer protects a DNS domain, d1.com, so that only DNS queries that match: *.d1.com will be forwarded to the origin server; any other domain name will not be forwarded. \n\nIn an attempt to exploit this vulnerability, an attacker would send a malicious DNS query with a domain name that is under the attacker\u2019s control (Ex: *.attacker.com). However, this query will not be forwarded to the origin because it doesn\u2019t match *.d1.com.\n\nMore focus on DNS is also on the docket at Imperva, in the form of a complete DNS offering later this year. The offering will include a fully managed secured DNS service, where you\u2019ll be able to administrate and secure your DNS zones, mitigating L3/4 volumetric, protocol &amp; DNS DDoS attacks.\n\nThe goal is to provide a best-in-class secured DNS solution with maximum reliability, security and visibility, complemented by the kind of full management capabilities you\u2019d expect from a world-class DNS solution.\n\nIn the meantime, if you have further questions about CVE-2020-1350, or need additional information on how Imperva can offer you top-notch, edge to end protection, [contact us](<https://www.imperva.com/contact-us/>) today.\n\nThe post [Imperva Shields Against Windows DNS Server RCE Vulnerability (CVE-2020-1350)](<https://www.imperva.com/blog/imperva-shields-against-windows-dns-server-rce-vulnerability-cve-2020-1350/>) appeared first on [Blog](<https://www.imperva.com/blog>).", "modified": "2020-07-21T11:24:14", "published": "2020-07-21T11:24:14", "id": "IMPERVABLOG:020B268DFC760B88704D35A6F4CF30D7", "href": "https://www.imperva.com/blog/imperva-shields-against-windows-dns-server-rce-vulnerability-cve-2020-1350/", "type": "impervablog", "title": "Imperva Shields Against Windows DNS Server RCE Vulnerability (CVE-2020-1350)", "cvss": {"score": 10.0, "vector": "AV:N/AC:L/Au:N/C:C/I:C/A:C"}}], "threatpost": [{"lastseen": "2020-07-16T08:28:41", "bulletinFamily": "info", "description": "A critical Microsoft Windows Server bug opens company networks to hackers, allowing them to potentially seize control of IT infrastructures. Microsoft issued a patch for the bug on Tuesday as part of its July Patch Tuesday roundup.\n\nIt turns out that the bug is 17 years old. Impacted are Windows Server versions from 2003-2019. The bug, found by researchers at Check Point, received a severity warning of 10 \u2013 the highest allowed. Most concerning to researchers however is that the bug is wormable, meaning a single exploit of the flaw can trigger a chain reaction that allows attacks to spread from one computer to another.\n\n\u201c[The] security flaw would enable a hacker to craft malicious DNS queries to the Windows DNS server, and achieve arbitrary code execution that could lead to the breach of the entire infrastructure,\u201d according to Check Point researcher Sagi Tzaik, who is credited for finding the flaw.\n\nMicrosoft released a patch for the vulnerability, identified as [CVE-2020-1350,](<https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-1350>) and [urged customers](<https://msrc-blog.microsoft.com/2020/07/14/july-2020-security-update-cve-2020-1350-vulnerability-in-windows-domain-name-system-dns-server/>) to prioritize an update to their systems. Check Point is calling the bug SigRed \u2013 a nod to the vulnerable DNS component and function \u201cdns.exe\u201d.\n\nA hacker can gain Domain Administrator rights over the server, \u201cenabling the hacker to intercept and manipulate users\u2019 emails and network traffic, make services unavailable, harvest users\u2019 credentials and more. In effect, the hacker could seize complete control of a corporation\u2019s IT,\u201d researchers wrote, in a technical analysis of the bug, posted Tuesday.\n\n## **Patching Is an Imperative **\n\nUpping the chance for exploitation by a hacker is the relatively simple prerequisites needed to exploit the vulnerability. \u201cThe likelihood of this vulnerability being exploited is high, as we internally found all of the primitives required to exploit this bug, which means a determined hacker could also find the same resources,\u201d researchers noted.\n\n\u201cThis issue results from a flaw in Microsoft\u2019s DNS server role implementation and affects all Windows Server versions. Non-Microsoft DNS Servers are not affected,\u201d [Microsoft wrote in a post Tuesday](<https://msrc-blog.microsoft.com/2020/07/14/july-2020-security-update-cve-2020-1350-vulnerability-in-windows-domain-name-system-dns-server/>). \u201cWhile this vulnerability is not currently known to be used in active attacks, it is essential that customers apply Windows updates to address this vulnerability as soon as possible.\u201d\n\nMechele Gruhn, principal security PM manager at the Microsoft Security Response Center, noted that \u201cif applying the update quickly is not practical, a [registry-based workaround is available](<https://support.microsoft.com/en-us/help/4569509>) that does not require restarting the server. The update and the workaround are both detailed in [CVE-2020-1350](<https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-1350>).\u201d\n\n\u201cCVE-2020-1350, a wormable remote code execution vulnerability in Windows DNS Server, could very well be the most critical Windows vulnerability released this year, receiving a rare 10 out of 10 CVSS score,\u201d Chris Hass, director of information security and research at Automox, told Threatpost.\n\n\u201cA wormable vulnerability like this is an attacker\u2019s dream. An unauthenticated hacker could send specially crafted packets to the vulnerable Windows DNS Server to exploit the machine, allowing for arbitrary code to be run in the context of the local system account. Not only will the attacker have full control of the system, but they will also be able to leverage the server as a distribution point, allowing the attacker to spread malware between systems without any user interaction. This wormable capability adds a whole other layer of severity and impact, allowing malware authors to write ransomware similar to notable wormable malware such as Wannacry and NotPetya,\u201d Hass said.\n\n## **Exploiting a 17-Year-Old Bug**\n\nThe flaw itself is an integer-overflow bug that can trigger a heap-based buffer overflow attack tied to the DNS module called dns.exe, which is responsible for answering DNS queries on Windows Servers.\n\nBy abusing the dns.exe module, two attack surfaces were created by researchers. One is a \u201cbug in the way the DNS server parses an incoming query.\u201d And the second is \u201ca bug in the way the DNS server parses a response (answer) for a forwarded query.\u201d\n\nThe attack requires researchers to first force a Windows DNS Server to parse responses from a malicious DNS NameServer. This employs the dns.exe module, which parses all supported response types. One of those supported response types is for a Secure Internet Access (SIG) query called SIG(O). Researchers focused their attention on creating a request that exceeded the maximum size request of 65,535 bytes, and causing the overflow. By using compressed data, researcher were able to create a successful crash.\n\n\u201cAlthough it seems that we crashed because we were trying to write values to unmapped memory, the heap can be shaped in a way that allows us to overwrite some meaningful values,\u201d they wrote.\n\nThis local attack then was replicated remotely, by \u201csmuggling DNS inside HTTP\u201d requests on Microsoft Explorer and Microsoft Edge browsers (Google Chrome and Firefox are not vulnerable to this type of attack). Because DNS can be transported over TCP \u2014 and Windows DNS Server supports this connection type \u2013 researchers were able to craft a HTTP payload.\n\n\u201cEven though this is an HTTP payload, sending it to our target DNS server on port 53 causes the Windows DNS Server to interpret this payload as if it was a DNS query,\u201d they wrote. Researchers were able to circumvent HTTP protections against similar malicious HTTP payloads by \u201csmuggling\u201d DNS query data inside the POST data located in the HTTP request.\n\nChromium-class browsers (Google Chrome and Mozilla Firefox) do not allow HTTP requests to port 53, therefore the bug can only be exploited Internet Explorer and Microsoft Edge.\n\n\u201cSuccessful exploitation of this vulnerability would have a severe impact, as you can often find unpatched Windows Domain environments, especially Domain Controllers. In addition, some internet service providers (ISPs) may even have set up their public DNS servers as WinDNS,\u201d Check Point wrote.\n\n**_BEC and enterprise email fraud is surging, but DMARC can help \u2013 if it\u2019s done right. On July 15 at 2 p.m. ET, join Valimail Global Technical Director Steve Whittle and Threatpost for a [FREE webinar](<https://attendee.gotowebinar.com/register/441045308082589963?source=art>), \u201cDMARC: 7 Common Business Email Mistakes.\u201d This technical \u201cbest practices\u201d session will cover constructing, configuring, and managing email authentication protocols to ensure your organization is protected. [Click here to register](<https://attendee.gotowebinar.com/register/441045308082589963?source=art>) for this Threatpost webinar, sponsored by Valimail._**\n", "modified": "2020-07-14T19:01:04", "published": "2020-07-14T19:01:04", "id": "THREATPOST:96E775E045D4DF55CC1B9A3AA0C28F70", "href": "https://threatpost.com/critical-dns-bug-windows-servers-infrastructure-takeover/157427/", "type": "threatpost", "title": "Critical DNS Bug Opens Windows Servers to Infrastructure Takeover", "cvss": {"score": 10.0, "vector": "AV:N/AC:L/Au:N/C:C/I:C/A:C"}}, {"lastseen": "2020-07-17T21:59:13", "bulletinFamily": "info", "description": "The U.S. Cybersecurity and Infrastructure Security Agency (CISA) is ordering all federal executive branch offices to apply a patch for a wormable Windows Server bug within 24 hours, warning of a \u201chigh potential for compromise of agency information systems.\u201d\n\nIn an [Emergency Directive](<https://cyber.dhs.gov/ed/20-03/>), the Department of Homeland Security (DHS) agency ordered the \u201cFederal Civilian Executive Branch\u201d to apply a patch Microsoft released Tuesday for the vulnerability, ([CVE-2020-1350](<https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-1350>)), by 2:00 pm ET Friday.\n\n\u201cCISA has determined that this vulnerability poses unacceptable significant risk to the Federal Civilian Executive Branch and requires an immediate and emergency action,\u201d the agency said in the directive.  \n[![](https://media.threatpost.com/wp-content/uploads/sites/103/2019/02/19151457/subscribe2.jpg)](<https://threatpost.com/newsletter-sign/>)\n\nSpecifically, the directive requires that by the deadline, all of the aforementioned agencies do the following: \u201cUpdate all endpoints running Windows Server operating systems; ensure the July 2020 Security Update or registry modification workaround is applied to all Windows Servers running the DNS role; ensure the July 2020 Security Update is applied to all Windows Servers and, if necessary and applicable, the registry change workaround is removed; and ensure technical and/or management controls are in place to ensure newly provisioned or previously disconnected servers are updated before connecting to agency networks.\u201d\n\nWhile there is no evidence of current active exploitation of the vulnerability, the CISA based its warning on \u201cthe likelihood of the vulnerability being exploited\u201d as well as \u201cthe widespread use of the affected software across the Federal enterprise,\u201d and \u201cthe grave impact of a successful compromise,\u201d according to the directive.\n\nThe CISA emergency directive includes:\n\n  * By 2:00 pm EDT, Friday, July 17, 2020, ensure the July 2020 Security Update or registry modification workaround is applied to all Windows Servers running the DNS role.\n  * By 2:00 pm EDT, Friday, July 24, 2020, ensure the July 2020 Security Update is applied to all Windows Servers and, if necessary and applicable, the registry change workaround is removed.\n  * By 2:00 pm EDT, Friday, July 24, 2020, ensure technical and/or management controls are in place to ensure newly provisioned or previously disconnected servers are updated before connecting to agency networks.\n\nThe agency recommends taking equipment offline if it can\u2019t be patched before the CISA deadline.\n\nThe vulnerability, a DNS flaw, was one of 123 bugs Microsoft patch in [July\u2019s Patch Tuesday](<https://threatpost.com/microsoft-tackles-123-fixes-july-patch-tuesday/157440/>), the fifth month in a row the company patched more than 100 vulnerabilities.\n\nCVE-2020-1350 is a remote code-execution vulnerability in the Windows Domain Name System (DNS) Server that was initially [discovered by Sagi Tzaik](<https://research.checkpoint.com/2020/resolving-your-way-into-domain-admin-exploiting-a-17-year-old-bug-in-windows-dns-servers/>), a researcher at Check Point. That bug exists due to the improper handling of requests sent to Windows DNS servers, according to researchers.\n\n\u201cA remote, unauthenticated attacker could exploit this vulnerability by sending a malicious request to a vulnerable Windows DNS server,\u201d wrote Satnam Narang, staff research engineer at Tenable, in the company\u2019s [Patch Tuesday analysis](<https://www.tenable.com/blog/microsoft-s-july-2020-patch-tuesday-addresses-123-cves-including-wormable-windows-dns-server>). \u201cSuccessful exploitation would allow the attacker to execute arbitrary code under the local system account context,\u201d\n\nMoreover, the vulnerability is wormable, which means it could spread from computer to computer without user interaction, making it all the more dangerous, he said.\n\nAlthough Emergency Directive 20-03 applies only to certain Executive Branch departments and agencies, the CISA also strongly recommends that all state and local governments, the private sector, and others patch this critical vulnerability as soon as possible.\n\nThe CISA has had its hands full lately warning on the exploit likelihood and danger of critical vulnerabilities that have either been discovered or patched in widely used hardware and software.\n\nOn July 14, the CISA [warned](<https://threatpost.com/critical-sap-bug-enterprise-system-takeover/157392/>) of a critical vulnerability for SAP customers, the successful exploitation of which could open the door for attackers to read and modify financial records; change banking details; read personal identifiable information (PII); and engage in other numerous types of disruptive behavior.\n\nA week before that, the agency urged all administrators to [implement an urgent patch](<https://threatpost.com/patch-critical-f5-flaw-active-attack/157164/>) for a critical vulnerability in F5 Networks\u2019 networking devices, which is being actively exploited by attackers to scrape credentials, launch malware and more.\n\nThe CISA also [warned](<https://threatpost.com/cisa-nation-state-attackers-palo-alto-networks-bug/157013/>) June 30 that foreign hackers were likely to exploit a critical vulnerability, CVE-2020-2021, in a raft of Palo Alto Networks firewalls and enterprise VPN appliances, ordering agencies to patch all affected devices.\n", "modified": "2020-07-17T15:43:00", "published": "2020-07-17T15:43:00", "id": "THREATPOST:363C332F7046A481C24C7172C55CF758", "href": "https://threatpost.com/cisa-emergency-directive-orders-immediate-fix-of-windows-dns-server-bug/157529/", "type": "threatpost", "title": "CISA Emergency Directive Orders Immediate Fix of Windows DNS Server Bug", "cvss": {"score": 10.0, "vector": "AV:N/AC:L/Au:N/C:C/I:C/A:C"}}, {"lastseen": "2020-07-16T08:27:57", "bulletinFamily": "info", "description": "A critical DNS bug and a publicly known elevation-of-privilege flaw top Microsoft\u2019s July Patch Tuesday list of 123 fixes. The [DNS flaw is a remote code-execution bug and is touted](<https://threatpost.com/critical-dns-bug-windows-servers-infrastructure-takeover/157427/>) as one of the most critical Windows vulnerabilities released this year, earning the highest-severity CVSS score of 10.\n\nThe elevation-of-privilege bug ([CVE-2020-1463](<https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-1463>)) bug received a less-severe \u201cimportant\u201d rating, and impacts the Windows 10 and Windows Server SharedStream Library component. It stems from the way it handles objects in memory. Researchers expressed concern because the bug is publicly known, making it ripe for exploitation.\n\n\u201cThe [SharedStream] vulnerability could allow an attacker to execute code with elevated permissions,\u201d said Todd Schell, senior product manager, security, Ivanti. However, \u201cthe attacker would need to be locally authenticated to exploit,\u201d he said.  \n[![](https://media.threatpost.com/wp-content/uploads/sites/103/2019/02/19151457/subscribe2.jpg)](<https://threatpost.com/newsletter-sign/>)\n\nThe more severe DNS flaw ([CVE-2020-1350](<https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-1350>)) is a remote code-execution vulnerability in the Windows Domain Name System (DNS) Server and was found by Sagi Tzaik, a researcher at Check Point. That bug exists due to the improper handling of requests sent to Windows DNS servers, according to researchers.\n\n\u201cA remote, unauthenticated attacker could exploit this vulnerability by sending a malicious request to a vulnerable Windows DNS server. Successful exploitation would allow the attacker to execute arbitrary code under the local system account context,\u201d wrote Satnam Narang, staff research engineer at Tenable, in the company\u2019s Patch Tuesday analysis.\n\nHe noted that Microsoft warned that this vulnerability is wormable, meaning it could spread from computer to computer without user interaction. \u201cOrganizations are strongly encouraged to patch their systems as soon as possible to address this vulnerability, as we expect that it won\u2019t be long before attackers begin to probe for and target vulnerable systems,\u201d he wrote as part of Tenable\u2019s analysis of the flaw.\n\n[Related content: [Critical DNS Bug Opens Windows Servers to Infrastructure Hijacking](<https://threatpost.com/critical-dns-bug-windows-servers-infrastructure-takeover/157427/>)]\n\n## **123 Fixes: Another Triple-Digit Month**\n\nIn all, Microsoft patched 123 bugs, 18 listed as critical and 105 listed as important in severity. Microsoft\u2019s advisories covered a wide swath of products, including Windows 10, Microsoft\u2019s new Chromium-based Edge browser, Internet Explorer (IE), Office and Office Services and Web Apps, Windows Defender, Skype for Business, Visual Studio, .NET Framework, OneDrive, Azure DevOp and Open Source Software.\n\n\u201cThat makes five straight months of 110+ CVEs released and brings the total for 2020 up to 742,\u201d wrote Zero Day Initiative (ZDI) researchers in their [Patch Tuesday analysis](<https://www.thezdi.com/blog/2020/7/14/the-july-2020-security-update-review>). \u201cFor comparison, Microsoft released patches for 851 CVEs in all of 2019. At this pace, Microsoft will eclipse that number next month. They have already passed their totals for 2017 (665) and 2018 (691).\u201d\n\nResearchers at ZDI singled out a \u201crare\u201d critical elevation-of-privilege vulnerability ([CVE-2020-1025](<https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-1025>)) in Microsoft Office: \u201cIt\u2019s rare to see an elevation-of-privilege bug rated critical in severity, but this vulnerability in SharePoint and Skype for Business servers certainly earns its rating.\u201d The flaw allows attackers to gain access to impacted servers through the improper handling of an [OAuth](<https://threatpost.com/microsoft-warns-oauth-attacks-cloud-app/157331/>) token.\n\n## **Patch Tuesday Bug Parade**\n\nMeanwhile, Adobe released five patches covering 13 CVEs in Adobe Cold Fusion, Download Manager, Genuine Service, Media Encoder and the Creative Cloud Desktop Application. Adobe patches included fixes for four critical vulnerabilities, as [outlined by Threatpost](<https://threatpost.com/adobe-critical-code-execution-bugs-july/157420/>).\n\nAlso on Tuesday, Google updated its [Google Chrome browser](<https://chromereleases.googleblog.com/2020/07/stable-channel-update-for-desktop.html>) with a security update tackling 38 vulnerabilities \u2014 including one critical. The critical bug (CVE-2020-6510) is a Chrome heap buffer overflow vulnerability tied to Chrome\u2019s background fetch function.\n\nThe Chrome security update is part of the release of Chrome 84 (84.0.4147.89), which notably includes deprecated support for TLS 1.0 and TLS 1.1.\n\n**_BEC and enterprise email fraud is surging, but DMARC can help \u2013 if it\u2019s done right. On July 15 at 2 p.m. ET, join Valimail Global Technical Director Steve Whittle and Threatpost for a _**[**_FREE webinar_**](<https://helpx.adobe.com/security/products/integrity_service/apsb20-42.html>)**_, \u201cDMARC: 7 Common Business Email Mistakes.\u201d This technical \u201cbest practices\u201d session will cover constructing, configuring, and managing email authentication protocols to ensure your organization is protected. _**[**_Click here to register_**](<https://helpx.adobe.com/security/products/integrity_service/apsb20-42.html>)**_ for this Threatpost webinar, sponsored by Valimail._**\n", "modified": "2020-07-14T21:32:06", "published": "2020-07-14T21:32:06", "id": "THREATPOST:7E6D2DBA11B2CCCE264B0982306FBEB1", "href": "https://threatpost.com/microsoft-tackles-123-fixes-july-patch-tuesday/157440/", "type": "threatpost", "title": "Microsoft Tackles 123 Fixes for July Patch Tuesday", "cvss": {"score": 10.0, "vector": "AV:N/AC:L/Au:N/C:C/I:C/A:C"}}], "huawei": [{"lastseen": "2020-07-16T13:27:26", "bulletinFamily": "software", "description": "Microsoft's security update in July 2020 addresses the CVE-2020-1350 vulnerability. To exploit the vulnerability, an unauthenticated attacker could send specially crafted requests to a Windows DNS server. An attacker who successfully exploited the vulnerability could run arbitrary code remotely. (Vulnerability ID: HWPSIRT-2020-59863)\nHuawei has released software updates to fix this vulnerability. This advisory is available at the following link:\nhttp://www.huawei.com/en/psirt/security-advisories/huawei-sa-20200716-01-dns-en", "modified": "2020-07-16T00:00:00", "published": "2020-07-16T00:00:00", "id": "HUAWEI-SA-20200716-01-DNS", "href": "https://www.huawei.com/en/psirt/security-advisories/2020/huawei-sa-20200716-01-dns-en", "title": "Security Advisory - Windows DNS Server Remote Code Execution Vulnerability", "type": "huawei", "cvss": {"score": 10.0, "vector": "AV:N/AC:L/Au:N/C:C/I:C/A:C"}}], "msrc": [{"lastseen": "2020-07-16T08:31:31", "bulletinFamily": "blog", "description": "Today we released an update for CVE-2020-1350, a Critical Remote Code Execution (RCE) vulnerability in Windows DNS Server that is classified as a \u2018wormable\u2019 vulnerability and has a CVSS base score of 10.0. This issue results from a flaw in Microsoft\u2019s DNS server role implementation and affects all Windows Server versions. Non-Microsoft DNS Servers are not affected. Wormable vulnerabilities have the potential to spread via malware between vulnerable computers without user interaction. Windows DNS Server is a core networking component. While this \u2026\n\n[ July 2020 Security Update: CVE-2020-1350 Vulnerability in Windows Domain Name System (DNS) Server Read More \u00bb](<https://msrc-blog.microsoft.com/2020/07/14/july-2020-security-update-cve-2020-1350-vulnerability-in-windows-domain-name-system-dns-server/>)\n\nThe post [July 2020 Security Update: CVE-2020-1350 Vulnerability in Windows Domain Name System (DNS) Server](<https://msrc-blog.microsoft.com/2020/07/14/july-2020-security-update-cve-2020-1350-vulnerability-in-windows-domain-name-system-dns-server/>) appeared first on [Microsoft Security Response Center](<https://msrc-blog.microsoft.com>).", "modified": "2020-07-14T17:01:00", "published": "2020-07-14T17:01:00", "id": "MSRC:79080D1EA83C3BB4689C763E5FACBDB5", "href": "https://msrc-blog.microsoft.com/2020/07/14/july-2020-security-update-cve-2020-1350-vulnerability-in-windows-domain-name-system-dns-server/", "type": "msrc", "title": "July 2020 Security Update:\u202fCVE-2020-1350 Vulnerability in Windows Domain Name System (DNS) Server", "cvss": {"score": 10.0, "vector": "AV:N/AC:L/Au:N/C:C/I:C/A:C"}}], "mscve": [{"lastseen": "2020-07-16T11:43:32", "bulletinFamily": "microsoft", "description": "A remote code execution vulnerability exists in Windows Domain Name System\nservers when they fail to properly handle requests. An attacker who\nsuccessfully exploited the vulnerability could run arbitrary code in the\ncontext of the Local System Account. Windows servers that are configured as\nDNS servers are at risk from this vulnerability.\n\nTo exploit the vulnerability, an unauthenticated attacker could send malicious\nrequests to a Windows DNS server.\n\nThe update addresses the vulnerability by modifying how Windows DNS servers\nhandle requests.\n\nThe following registry modification has been identified as a workaround for\nthis vulnerability.\n\n    \n    \n      HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\DNS\\Parameters \n      DWORD = TcpReceivePacketSize \n      Value = 0xFF00\n    \n\n**Note:** A restart of the DNS Service is required to take effect.\n\nPlease see [4569509](https://support.microsoft.com/help/4569509) for more\ninformation.\n\n**To remove the workaround:**\n\nAfter applying the patch, the admin can remove the value TcpReceivePacketSize\nand its corresponding data so that everything else under the key\nHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\DNS\\Parameters remains as\nbefore.\n\n", "modified": "2020-07-15T07:00:00", "id": "MS:CVE-2020-1350", "href": "https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-1350", "published": "2020-07-15T07:00:00", "title": "Windows DNS Server Remote Code Execution Vulnerability", "type": "mscve", "cvss": {"score": 10.0, "vector": "AV:N/AC:L/Au:N/C:C/I:C/A:C"}}], "thn": [{"lastseen": "2020-07-15T08:25:53", "bulletinFamily": "info", "description": "[![hacking windows dns server](https://thehackernews.com/images/-CFswC_0BsxM/Xw3l4OFeD0I/AAAAAAAA3BU/WOcga12uuyA8n43M9fyL5rlNdMXOc7CTwCLcBGAsYHQ/s728-e100/windows-dns-server-hacking.jpg)](<https://thehackernews.com/images/-CFswC_0BsxM/Xw3l4OFeD0I/AAAAAAAA3BU/WOcga12uuyA8n43M9fyL5rlNdMXOc7CTwCLcBGAsYHQ/s728-e100/windows-dns-server-hacking.jpg>)\n\nCybersecurity researchers today disclosed a new highly critical \"wormable\" vulnerability\u2014carrying a severity score of 10 out of 10 on the CVSS scale\u2014affecting Windows Server versions 2003 to 2019.  \n  \nThe 17-year-old remote code execution flaw ([CVE-2020-1350](<https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-1350>)), dubbed '**SigRed**' by Check Point, could allow an unauthenticated, remote attacker to gain domain administrator privileges over targeted servers and seize complete control of an organization's IT infrastructure.  \n  \nA threat actor can exploit SigRed vulnerability by sending crafted malicious DNS queries to a Windows DNS server and achieve arbitrary code execution, enabling the hacker to intercept and manipulate users' emails and network traffic, make services unavailable, harvest users' credentials and much more.  \n  \nIn a detailed [report](<https://research.checkpoint.com/2020/resolving-your-way-into-domain-admin-exploiting-a-17-year-old-bug-in-windows-dns-servers/>) shared with The Hacker News, the Check Point researcher **Sagi Tzadik** confirmed that the flaw is wormable in nature, allowing attackers to launch an attack that can spread from one vulnerable computer to another without any human interaction.  \n\n\n  \n\"A single exploit can start a chain reaction that allows attacks to spread from vulnerable machine to vulnerable machine without requiring any human interaction,\" the researcher said.  \n  \n\"This means that a single compromised machine could be a 'super spreader,' enabling the attack to spread throughout an organization's network within minutes of the first exploit.\"  \n  \nAfter the cybersecurity firm responsibly disclosed its findings to Microsoft, the Windows maker prepared a patch for the vulnerability and began rolling it out starting today as part of its July Patch Tuesday, which also includes security updates for 122 other vulnerabilities, with a total 18 flaws listed as critical, and 105 as important in severity.  \n  \nMicrosoft [said](<https://msrc-blog.microsoft.com/2020/07/14/july-2020-security-update-cve-2020-1350-vulnerability-in-windows-domain-name-system-dns-server/>) it found no evidence to show that the bug has been actively exploited by attackers, and advised users to install the patches immediately.  \n  \n\"Windows DNS Server is a core networking component. While this vulnerability is not currently known to be used in active attacks, it is essential that customers apply Windows updates to address this vulnerability as soon as possible,\" Microsoft said.  \n  \n\n\n##  Crafting Malicious DNS Responses\n\n  \nStating that the objective was to identify a vulnerability that would let an unauthenticated attacker compromise a Windows Domain environment, Check Point researchers said they focused on Windows DNS, specifically taking a closer look at how a DNS server parses an incoming query or a response for a forwarded query.  \n  \nA forwarded query happens when a DNS server cannot resolve the IP address for a given domain name (e.g., www.google.com), resulting in the query being forwarded to an authoritative DNS name server (NS).  \n  \n\n\n  \nTo exploit this architecture, SigRed involves configuring a domain's (\"deadbeef.fun\") [NS resource records](<https://en.wikipedia.org/wiki/List_of_DNS_record_types>) to point to a malicious name server (\"ns1.41414141.club\"), and querying the target DNS server for the domain in order to have the latter parse responses from the name server for all subsequent queries related to the domain or its subdomains.  \n  \nWith this setup in place, an attacker can trigger an integer overflow flaw in the function that parses incoming responses for forwarded queries (\"dns.exe!SigWireRead\") to send a DNS response that contains a [SIG resource record](<https://tools.ietf.org/html/rfc2535#section-2.3.1>) larger than 64KB and induce a \"controlled heap-based buffer overflow of roughly 64KB over a small allocated buffer.\"  \n  \nPut differently; the flaw targets the function responsible for allocating memory for the resource record (\"RR_AllocateEx\") to generate a result bigger than 65,535 bytes to cause an integer overflow that leads to a much smaller allocation than expected.  \n  \nBut with a single DNS message limited to 512 bytes in UDP (or 4,096 bytes if the server supports [extension mechanisms](<https://en.wikipedia.org/wiki/Extension_mechanisms_for_DNS>)) and 65,535 bytes in TCP, the researchers found that a SIG response with a lengthy signature alone wasn't enough to trigger the vulnerability.  \n\n\n  \nTo achieve this, the attack cleverly takes advantage of [DNS name compression](<https://powerdns.org/hello-dns/basic.md.html#dnsbasics>) in DNS responses to create a buffer overflow using the aforementioned technique to increase the allocation's size by a significant amount.  \n  \n\n\n##  Remote Exploitation of the Flaw\n\n  \nThat's not all. SigRed can be triggered remotely via a browser in limited scenarios (e.g., Internet Explorer and non-Chromium based Microsoft Edge browsers), allowing an attacker to abuse Windows DNS servers' support for [connection reuse and query pipelining](<https://tools.ietf.org/html/rfc7766#section-6.2.1>) features to \"smuggle\" a DNS query inside an HTTP request payload to a target DNS server upon visiting a website under their control.  \n  \nWhat's more, the bug can be further exploited to leak memory addresses by corrupting the metadata of a DNS resource record and even achieve [write-what-where](<https://cwe.mitre.org/data/definitions/123.html>) capabilities, allowing an adversary to hijack the execution flow and cause it to execute unintended instructions.  \n  \n\n\n[![](https://thehackernews.com/images/-HEx60rYsUag/Xw28tH1tAeI/AAAAAAAAAjg/NJQx1bGwsz4XXVX6VMdIZz_fT6pv4UyxACLcBGAsYHQ/s728-e100/dns-hacking.jpg)](<https://thehackernews.com/images/-HEx60rYsUag/Xw28tH1tAeI/AAAAAAAAAjg/NJQx1bGwsz4XXVX6VMdIZz_fT6pv4UyxACLcBGAsYHQ/s728-e100/dns-hacking.jpg>)\n\n  \nSurprisingly, DNS clients (\"dnsapi.dll\") are not susceptible to the same bug, leading the researchers to suspect that \"Microsoft manages two completely different code bases for the DNS server and the DNS client, and does not synchronize bug patches between them.\"  \n  \nGiven the severity of the vulnerability and the high chances of active exploitation, it's recommended that users patch their affected Windows DNS Servers to mitigate the risk.  \n  \nAs a temporary workaround, the maximum length of a DNS message (over TCP) can be set to \"0xFF00\" to eliminate the chances of a buffer overflow:  \n  \n\n\n> reg add \"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\DNS\\Parameters\" /v \"TcpReceivePacketSize\" /t REG_DWORD /d 0xFF00 /f  \n  \nnet stop DNS &amp;&amp; net start DNS\n\n  \n\"A DNS server breach is a very serious thing. Most of the time, it puts the attacker just one inch away from breaching the entire organization. There are only a handful of these vulnerability types ever released,\" Check Point's Omri Herscovici told The Hacker News.  \n  \n\"Every organization, big or small using Microsoft infrastructure is at major security risk, if left unpatched. The risk would be a complete breach of the entire corporate network.\"\n", "modified": "2020-07-15T08:02:06", "published": "2020-07-14T17:13:00", "id": "THN:DBFCCEBE2752BA05D9181D55D3477666", "href": "https://thehackernews.com/2020/07/windows-dns-server-hacking.html", "type": "thn", "title": "17-Year-Old Critical 'Wormable' RCE Vulnerability Impacts Windows DNS Servers", "cvss": {"score": 0.0, "vector": "NONE"}}], "avleonov": [{"lastseen": "2020-07-18T16:01:43", "bulletinFamily": "blog", "description": "This episode is based on posts from [my Telegram channel avleonovcom](<https://t.me/avleonovcom>), published in the last 2 weeks. So, if you use Telegram, please subscribe. I update it frequently.\n\n![Barapass, Tsunami scanner, vulnerabilities in Windows DNS Server and SAP products, weird attack on Twitter](https://avleonov.com/wp-content/uploads/2020/07/Barapass-Tsunami-scanner-vulnerabilities-in-Windows-DNS-Server-and-SAP-products-weird-attack-on-twitter.png)\n\n## Barapass update\n\nI recently [released an update](<https://github.com/leonov-av/barapass>) to my password manager **barapass**. BTW, it seems to be my only pet project at the MVP stage, which I use every day. ![\ud83d\ude05](https://s.w.org/images/core/emoji/12.0.0-1/72x72/1f605.png)\n\nWhat's new:\n\n  1. Now I am sure that it works on Windows 10 without WSL. And you can run it beautifully even with the icon. ![\ud83d\ude0a](https://s.w.org/images/core/emoji/12.0.0-1/72x72/1f60a.png) Read more about installation in Windows [in this file](<https://github.com/leonov-av/barapass/blob/master/how_to_use_barapass_in_windows.txt>).\n  2. Not only \"copy the next value to the clipboard\" (or \"revolver mode\" ) is now possible in the search results section. You can also get the previous value or copy the same value one again if it was somehow erased in the clipboard. Previously, I had to retype the search request each time to do this, and it was quite annoying. By the way, I unexpectedly discovered that the user input history inside the application magically works in the Windows shell (using up and down arrows) without any additional coding. On Linux it does not.\n  3. You can set a startup command, for example, to decrypt the container.\n  4. The startup command and quick (favorite) commands are now in settings.json and not hard-coded.\n  5. settings.json, container files and decrypted files are now in \"files\" directory. It became more convenient to update barapass, just change the scripts in the root directory and that\u2019s it. I divided the scripts into several files, now it should be more clear how it works.\n\nSo, if you need a minimalistic console password manager in which you can easily use any encryption you like - welcome! You can read more about **barapass **[in my previous post](<https://avleonov.com/2019/09/17/barapass-console-password-manager/>).\n\n## Google Tsunami\n\nHave you heard about this new open source Tsunami vulnerability scanner released by Google ([github](<https://github.com/google/tsunami-security-scanner>))? What do you think about it? Is it the real thing or just another [useless automation layer over nmap](<https://github.com/google/tsunami-security-scanner/blob/master/docs/orchestration.md>)? I am now more for the second option. And I'm pretty skeptical that they will make effective and safe plugins for exploit-based vulnerability detection. The fact that this is 99.5% Java code doesn't make me enthusiastic as well. But, of course, I want to believe that it will be new \"kubernetes\" in the Vulnerability Management area. Let's discuss in [@avleonovchat](<https://t.me/avleonovchat>)\n\n![Google Tsunami poll](https://avleonov.com/wp-content/uploads/2020/07/image.png)\n\nVote here: <https://t.me/avleonovcom/731>\n\n## RCE in Windows DNS Server\n\nYep, yet another short post about **SIGRed **([video](<https://www.youtube.com/watch?v=PUlMmhD5it8>), [MS CVE-2020-1350](<https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-1350>)). Getting RCE with only a DNS request is really impressive. And it was there for 17 years! OMG, what attackers could do with this in corporate environment! [Checkpoint guys stated that](<https://research.checkpoint.com/2020/resolving-your-way-into-domain-admin-exploiting-a-17-year-old-bug-in-windows-dns-servers/>) \"Due to time constraints, we did not continue to pursue the exploitation of the bug (which includes chaining together all of the exploitation primitives), but we do believe that a determined attacker will be able to exploit it.\"\n\n![RCE in Windows DNS Server poll](https://avleonov.com/wp-content/uploads/2020/07/image-1.png)\n\nVote here: <https://t.me/avleonovcom/733>\n\n## SAP RECON\n\nIf your organization uses **SAP **(my condolences), you should initiate some patching right now and make sure this stuff is NOT available on your network perimeter. There is already an [exploit](<https://github.com/chipik/SAP_RECON>) available for these vulnerabilities:\n\n[CVE-2020-6287](<https://nvd.nist.gov/vuln/detail/CVE-2020-6287>) - unauthenticated attacker can \"execute configuration tasks to perform critical actions against the SAP Java system, including the ability to create an administrative user\"  \n[CVE-2020-6286](<https://nvd.nist.gov/vuln/detail/CVE-2020-6286>) - unauthenticated attacker can make Path Traversal\n\nI also found a funny bug: **Nessus **has a [remote plugin](<https://www.tenable.com/plugins/nessus/138506>) to detect these vulnerabilities, but you were not be able to find it on **Tenable **website by \"CVE-2020-6287\" in [CVE filter](<https://www.tenable.com/plugins/search?q=cves%3A\\(%22CVE-2020-6287%22\\)&sort=&page=1>). Why? When they edited CVE list in plugin, they have put \"CVE-2020-6286\" there twice. \n\n![SAP RECON Nessus](https://avleonov.com/wp-content/uploads/2020/07/tenable3.png)\n\n![\ud83e\udd26\ud83c\udffb\u200d\u2642\ufe0f](https://s.w.org/images/core/emoji/12.0.0-1/72x72/1f926-1f3fb-200d-2642-fe0f.png) Sometimes such things happen. \n\n## Weird attack on Twitter\n\nA little bit about Twitter? Of course, [the last incident](<https://edition.cnn.com/2020/07/16/tech/twitter-hack-security-analysis/index.html>) puzzled me a lot. Let's say you have an access to the Twitter accounts of Bill Gates, Elon Musk, Obama, Apple and others, and you post a silly Bitcoin scam? Whaat? ![\ud83e\udd2a](https://s.w.org/images/core/emoji/12.0.0-1/72x72/1f92a.png)\n\n![Weird attack on Twitter](https://avleonov.com/wp-content/uploads/2020/07/Twitter_case.png)\n\nI recently had some practice in writing email templates for antiphishing trainings (btw, my [video about antiphishing](<https://www.youtube.com/watch?v=ODyJRBUZMfY>)) and was amazed what results can be achieved with regular email messages if you add a little bit of imagination and choose the right time. Even IT security professionals open files and urls, input credentials on fake sites, etc.!\n\nIt is absolutely clear that these attackers could have done something humongous. Starting from the massive gathering of user accounts / distribution of any malware through high-quality phishing websites and ending with advanced market manipulation. And instead of all this, some messages about bitcoins. It\u2019s strange.\n\n![Weird attack on Twitter poll](https://avleonov.com/wp-content/uploads/2020/07/image-2.png)\n\nVote here: <https://t.me/avleonovcom/741>\n\n![](http://feeds.feedburner.com/~r/avleonov/~4/AmsqOJSEpTc)", "modified": "2020-07-18T18:31:16", "published": "2020-07-18T18:31:16", "id": "AVLEONOV:1ABE5F69187E5F9F8625DA462772F80C", "href": "http://feedproxy.google.com/~r/avleonov/~3/AmsqOJSEpTc/", "type": "avleonov", "title": "Barapass, Tsunami scanner, vulnerabilities in Windows DNS Server and SAP products, weird attack on Twitter", "cvss": {"score": 10.0, "vector": "AV:N/AC:L/Au:N/C:C/I:C/A:C"}}], "krebs": [{"lastseen": "2020-07-16T10:01:23", "bulletinFamily": "blog", "description": "**Microsoft** today released updates to plug a whopping 123 security holes in **Windows** and related software, including fixes for a critical, \"wormable\" flaw in **Windows Server** versions that Microsoft says is likely to be exploited soon. While this particular weakness mainly affects enterprises, July's care package from Redmond has a little something for everyone. So if you're a Windows (ab)user, it's time once again to back up and patch up (preferably in that order).\n\n![](https://krebsonsecurity.com/wp-content/uploads/2020/07/cworm.png)Top of the heap this month in terms of outright scariness is [CVE-2020-1350](<https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-1350>), which concerns a remotely exploitable bug in more or less all versions of Windows Server that attackers could use to install malicious software simply by sending a specially crafted DNS request.\n\nMicrosoft said it is not aware of reports that anyone is exploiting the weakness (yet), but the flaw has been assigned a [CVSS score](<https://www.first.org/cvss/user-guide>) of 10, which translates to \"easy to attack\" and \"likely to be exploited.\"\n\n\"We consider this to be a wormable vulnerability, meaning that it has the potential to spread via malware between vulnerable computers without user interaction,\" Microsoft wrote in its documentation of CVE-2020-1350. \"DNS is a foundational networking component and commonly installed on Domain Controllers, so a compromise could lead to significant service interruptions and the compromise of high level domain accounts.\"\n\nCVE-2020-1350 is just the latest worry for enterprise system administrators in charge of patching dangerous bugs in widely-used software. Over the past couple of weeks, fixes for flaws with high severity ratings have been released for a broad array of software products typically used by businesses, [including Citrix, F5, Juniper, Oracle and SAP](<https://www.zdnet.com/article/recon-bug-lets-hackers-create-admin-accounts-on-sap-servers/>). This at a time when many organizations are already short-staffed and dealing with employees working remotely thanks to the COVID-19 pandemic.\n\nThe Windows Server vulnerability isn't the only nasty one addressed this month that malware or malcontents can use to break into systems without any help from users. A full 17 other critical flaws fixed in this release tackle security weaknesses that Microsoft assigned its most dire \"critical\" rating, such as in **Office**, **Internet Exploder**, **SharePoint**, **Visual Studio**, and Microsoft's **.NET Framework**.\n\nSome of the more eyebrow-raising critical bugs addressed this month include [CVE-2020-1410](<https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-1410>), which according to **Recorded Future** concerns the Windows Address Book and could be exploited via a malicious vcard file. Then there's [CVE-2020-1421](<https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-1421>), which protects against potentially malicious .LNK files (think [Stuxnet](<https://krebsonsecurity.com/2010/07/microsoft-to-issue-emergency-patch-for-critical-windows-bug/>)) that could be exploited via an infected removable drive or remote share. And we have the dynamic duo of [CVE-2020-1435](<https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-1435>) and [CVE-2020-1436](<https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-1436>), which involve problems with the way Windows handles images and fonts that could both be exploited to install malware just by getting a user to click a booby-trapped link or document.\n\nNot to say flaws rated \"important\" as opposed to critical aren't also a concern. Chief among those is [CVE-2020-1463](<https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-1463>), a problem within **Windows 10** and **Server 2016** or later that was detailed publicly prior to this month's Patch Tuesday.\n\nBefore you update with this month\u2019s patch batch, please make sure you have backed up your system and/or important files. It\u2019s not uncommon for a particular Windows update to hose one\u2019s system or prevent it from booting properly, and some updates even have been known to erase or corrupt files. Last month's bundle of joy from Microsoft sent my Windows 10 system into a perpetual crash state. Thankfully, I was able to restore from a recent backup.\n\nSo do yourself a favor and backup _before_ installing any patches. Windows 10 even has [some built-in tools](<https://lifehacker.com/how-to-back-up-your-computer-automatically-with-windows-1762867473>) to help you do that, either on a per-file/folder basis or by making a complete and bootable copy of your hard drive all at once.\n\nAlso, keep in mind that Windows 10 is set to apply patches on its own schedule, which means if you delay backing up you could be in for a wild ride. If you wish to ensure the operating system has been set to pause updating so you can back up your files and/or system _before_ the operating system decides to reboot and install patches whenever it sees fit, see [this guide](<https://www.computerworld.com/article/3543189/check-to-make-sure-you-have-windows-updates-paused.html>).\n\nAs always, if you experience glitches or problems installing any of these patches this month, please consider leaving a comment about it below; there\u2019s a better-than-even chance other readers have experienced the same and may chime in here with some helpful tips. Also, keep an eye on [the AskWoody blog from Woody Leonhard](<https://www.askwoody.com/>), who keeps a reliable lookout for buggy Microsoft updates each month.", "modified": "2020-07-14T21:45:28", "published": "2020-07-14T21:45:28", "id": "KREBS:1A886B22AAF8ADC53874F0E126C5A96D", "href": "https://krebsonsecurity.com/2020/07/wormable-flaw-leads-july-microsoft-patches/", "type": "krebs", "title": "\u2018Wormable\u2019 Flaw Leads July Microsoft Patches", "cvss": {"score": 10.0, "vector": "AV:N/AC:L/Au:N/C:C/I:C/A:C"}}], "openvas": [{"lastseen": "2020-07-21T19:50:57", "bulletinFamily": "scanner", "description": "This host is missing a critical security\n  update according to Microsoft KB4565536", "modified": "2020-07-20T00:00:00", "published": "2020-07-15T00:00:00", "id": "OPENVAS:1361412562310817232", "href": "http://plugins.openvas.org/nasl.php?oid=1361412562310817232", "title": "Microsoft Windows Multiple Vulnerabilities (KB4565536)", "type": "openvas", "sourceData": "# Copyright (C) 2020 Greenbone Networks GmbH\n# Some text descriptions might be excerpted from (a) referenced\n# source(s), and are Copyright (C) by the respective right holder(s).\n#\n# SPDX-License-Identifier: GPL-2.0-or-later\n#\n# This program is free software; you can redistribute it and/or\n# modify it under the terms of the GNU General Public License\n# as published by the Free Software Foundation; either version 2\n# of the License, or (at your option) any later version.\n#\n# This program is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with this program; if not, write to the Free Software\n# Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n\nif(description)\n{\n  script_oid(\"1.3.6.1.4.1.25623.1.0.817232\");\n  script_version(\"2020-07-20T05:00:04+0000\");\n  script_cve_id(\"CVE-2020-1085\", \"CVE-2020-1267\", \"CVE-2020-1333\", \"CVE-2020-1350\",\n                \"CVE-2020-1354\", \"CVE-2020-1359\", \"CVE-2020-1360\", \"CVE-2020-1365\",\n                \"CVE-2020-1371\", \"CVE-2020-1373\", \"CVE-2020-1384\", \"CVE-2020-1389\",\n                \"CVE-2020-1390\", \"CVE-2020-1396\", \"CVE-2020-1397\", \"CVE-2020-1400\",\n                \"CVE-2020-1401\", \"CVE-2020-1403\", \"CVE-2020-1407\", \"CVE-2020-1408\",\n                \"CVE-2020-1409\", \"CVE-2020-1410\", \"CVE-2020-1412\", \"CVE-2020-1419\",\n                \"CVE-2020-1421\", \"CVE-2020-1427\", \"CVE-2020-1428\", \"CVE-2020-1430\",\n                \"CVE-2020-1435\", \"CVE-2020-1436\", \"CVE-2020-1437\", \"CVE-2020-1438\",\n                \"CVE-2020-1468\");\n  script_tag(name:\"cvss_base\", value:\"10.0\");\n  script_tag(name:\"cvss_base_vector\", value:\"AV:N/AC:M/Au:N/C:C/I:C/A:C\");\n  script_tag(name:\"last_modification\", value:\"2020-07-20 05:00:04 +0000 (Mon, 20 Jul 2020)\");\n  script_tag(name:\"creation_date\", value:\"2020-07-15 20:23:57 +0530 (Wed, 15 Jul 2020)\");\n  script_name(\"Microsoft Windows Multiple Vulnerabilities (KB4565536)\");\n\n  script_tag(name:\"summary\", value:\"This host is missing a critical security\n  update according to Microsoft KB4565536\");\n\n  script_tag(name:\"vuldetect\", value:\"Checks if a vulnerable version is present\n  on the target host.\");\n\n  script_tag(name:\"insight\", value:\"Multiple flaws exists due to,\n\n  - Windows Domain Name System servers fail to properly handle requests (SIGRed, CVE-2020-1350).\n\n  - DirectWrite fails to properly handle objects in memory.\n\n  - Windows Address Book (WAB) fails to properly processes vcard files.\n\n  - Windows Graphics Device Interface (GDI) fails to properly handle\n    objects in the memory.\n\n  - Windows Network Connections Service fails to handle objects in memory.\n\n  Please see the references for more information about the vulnerabilities.\");\n\n  script_tag(name:\"impact\", value:\"Successful exploitation will allow an attacker\n  to execute arbitrary code, elevate privilges, disclose sensitive information\n  and denial of service attacks.\");\n\n  script_tag(name:\"affected\", value:\"- Microsoft Windows Server 2008 for 32-bit Systems Service Pack 2\n\n  - Microsoft Windows Server 2008 for x64-based Systems Service Pack 2\");\n\n  script_tag(name:\"solution\", value:\"The vendor has released updates. Please see\n  the references for more information.\");\n\n  script_tag(name:\"solution_type\", value:\"VendorFix\");\n  script_tag(name:\"qod_type\", value:\"executable_version\");\n  script_xref(name:\"URL\", value:\"https://support.microsoft.com/en-us/help/4565536\");\n  script_category(ACT_GATHER_INFO);\n  script_copyright(\"Copyright (C) 2020 Greenbone Networks GmbH\");\n  script_family(\"Windows : Microsoft Bulletins\");\n  script_dependencies(\"smb_reg_service_pack.nasl\");\n  script_require_ports(139, 445);\n  script_mandatory_keys(\"SMB/WindowsVersion\");\n  exit(0);\n}\n\ninclude(\"smb_nt.inc\");\ninclude(\"secpod_reg.inc\");\ninclude(\"version_func.inc\");\ninclude(\"secpod_smb_func.inc\");\n\nif(hotfix_check_sp(win2008:3, win2008x64:3) <= 0){\n  exit(0);\n}\n\ndllPath = smb_get_system32root();\nif(!dllPath)\n  exit(0);\n\nfileVer = fetch_file_version(sysPath:dllPath, file_name:\"Gdiplus.dll\");\nif(!fileVer)\n  exit(0);\n\nif(version_is_less(version:fileVer, test_version:\"5.2.6003.20883\")) {\n  report = report_fixed_ver(file_checked:dllPath + \"\\Gdiplus.dll\",\n                            file_version:fileVer, vulnerable_range:\"Less than 5.2.6003.20883\");\n  security_message(data:report);\n  exit(0);\n}\n\nexit(99);\n", "cvss": {"score": 10.0, "vector": "AV:N/AC:L/Au:N/C:C/I:C/A:C"}}, {"lastseen": "2020-07-21T19:51:37", "bulletinFamily": "scanner", "description": "This host is missing a critical security\n  update according to Microsoft KB4565524", "modified": "2020-07-20T00:00:00", "published": "2020-07-15T00:00:00", "id": "OPENVAS:1361412562310817230", "href": "http://plugins.openvas.org/nasl.php?oid=1361412562310817230", "title": "Microsoft Windows Multiple Vulnerabilities (KB4565524)", "type": "openvas", "sourceData": "# Copyright (C) 2020 Greenbone Networks GmbH\n# Some text descriptions might be excerpted from (a) referenced\n# source(s), and are Copyright (C) by the respective right holder(s).\n#\n# SPDX-License-Identifier: GPL-2.0-or-later\n#\n# This program is free software; you can redistribute it and/or\n# modify it under the terms of the GNU General Public License\n# as published by the Free Software Foundation; either version 2\n# of the License, or (at your option) any later version.\n#\n# This program is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with this program; if not, write to the Free Software\n# Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n\nif(description)\n{\n  script_oid(\"1.3.6.1.4.1.25623.1.0.817230\");\n  script_version(\"2020-07-20T05:00:04+0000\");\n  script_cve_id(\"CVE-2020-1085\", \"CVE-2020-1267\", \"CVE-2020-1333\", \"CVE-2020-1350\",\n                \"CVE-2020-1351\", \"CVE-2020-1354\", \"CVE-2020-1359\", \"CVE-2020-1360\",\n                \"CVE-2020-1365\", \"CVE-2020-1371\", \"CVE-2020-1373\", \"CVE-2020-1374\",\n                \"CVE-2020-1384\", \"CVE-2020-1389\", \"CVE-2020-1390\", \"CVE-2020-1396\",\n                \"CVE-2020-1397\", \"CVE-2020-1400\", \"CVE-2020-1401\", \"CVE-2020-1402\",\n                \"CVE-2020-1403\", \"CVE-2020-1407\", \"CVE-2020-1408\", \"CVE-2020-1409\",\n                \"CVE-2020-1410\", \"CVE-2020-1412\", \"CVE-2020-1419\", \"CVE-2020-1421\",\n                \"CVE-2020-1427\", \"CVE-2020-1428\", \"CVE-2020-1430\", \"CVE-2020-1432\",\n                \"CVE-2020-1435\", \"CVE-2020-1436\", \"CVE-2020-1437\", \"CVE-2020-1438\",\n                \"CVE-2020-1468\");\n  script_tag(name:\"cvss_base\", value:\"9.3\");\n  script_tag(name:\"cvss_base_vector\", value:\"AV:N/AC:M/Au:N/C:C/I:C/A:C\");\n  script_tag(name:\"last_modification\", value:\"2020-07-20 05:00:04 +0000 (Mon, 20 Jul 2020)\");\n  script_tag(name:\"creation_date\", value:\"2020-07-15 18:26:24 +0530 (Wed, 15 Jul 2020)\");\n  script_name(\"Microsoft Windows Multiple Vulnerabilities (KB4565524)\");\n\n  script_tag(name:\"summary\", value:\"This host is missing a critical security\n  update according to Microsoft KB4565524\");\n\n  script_tag(name:\"vuldetect\", value:\"Checks if a vulnerable version is present\n  on the target host.\");\n\n  script_tag(name:\"insight\", value:\"Multiple flaws exists due to,\n\n  - Windows Domain Name System servers fail to properly handle requests (SIGRed, CVE-2020-1350).\n\n  - Windows Event Logging Service fails to properly handle memory.\n\n  - Windows Network Location Awareness Service fails to properly\n    handle objects in memory.\n\n  - Windows Jet Database Engine fails to properly handle objects in memory.\n\n  - Windows Network Connections Service fails to properly handle\n    objects in memory.\n\n  - Windows Cryptography Next Generation (CNG) Key Isolation service\n    fails to properly handle memory.\n\n  Please see the references for more information about the vulnerabilities.\");\n\n  script_tag(name:\"impact\", value:\"Successful exploitation will allow an attacker\n  to execute arbitrary code, elevate privilges, disclose sensitive information\n  and denial of service attacks.\");\n\n  script_tag(name:\"affected\", value:\"- Microsoft Windows Server 2008 R2 for x64-based Systems Service Pack 1\n\n  - Microsoft Windows Server 2012\n\n  - Microsoft Windows 7 for x64-based Systems Service Pack 1\n\n  - Microsoft Windows 7 for 32-bit Systems Service Pack 1\");\n\n  script_tag(name:\"solution\", value:\"The vendor has released updates. Please see\n  the references for more information.\");\n\n  script_tag(name:\"solution_type\", value:\"VendorFix\");\n  script_tag(name:\"qod_type\", value:\"executable_version\");\n  script_xref(name:\"URL\", value:\"https://support.microsoft.com/en-us/help/4565524\");\n  script_category(ACT_GATHER_INFO);\n  script_copyright(\"Copyright (C) 2020 Greenbone Networks GmbH\");\n  script_family(\"Windows : Microsoft Bulletins\");\n  script_dependencies(\"smb_reg_service_pack.nasl\");\n  script_require_ports(139, 445);\n  script_mandatory_keys(\"SMB/WindowsVersion\");\n  exit(0);\n}\n\ninclude(\"smb_nt.inc\");\ninclude(\"secpod_reg.inc\");\ninclude(\"version_func.inc\");\ninclude(\"secpod_smb_func.inc\");\n\nif(hotfix_check_sp(win2008r2:2, win2012:1, win7x64:2, win7:2) <= 0){\n  exit(0);\n}\n\ndllPath = smb_get_system32root();\nif(!dllPath)\n  exit(0);\n\nfileVer = fetch_file_version(sysPath:dllPath, file_name:\"Gdiplus.dll\");\nif(!fileVer)\n  exit(0);\n\nif(version_is_less(version:fileVer, test_version:\"5.2.7601.24557\")) {\n  report = report_fixed_ver(file_checked:dllPath + \"\\Gdiplus.dll\",\n                            file_version:fileVer, vulnerable_range:\"Less than 5.2.7601.24557\");\n  security_message(data:report);\n  exit(0);\n}\n\nexit(99);\n", "cvss": {"score": 10.0, "vector": "AV:N/AC:L/Au:N/C:C/I:C/A:C"}}, {"lastseen": "2020-07-21T19:51:31", "bulletinFamily": "scanner", "description": "This host is missing a critical security\n  update according to Microsoft KB4565541", "modified": "2020-07-20T00:00:00", "published": "2020-07-15T00:00:00", "id": "OPENVAS:1361412562310817231", "href": "http://plugins.openvas.org/nasl.php?oid=1361412562310817231", "title": "Microsoft Windows Multiple Vulnerabilities (KB4565541)", "type": "openvas", "sourceData": "# Copyright (C) 2020 Greenbone Networks GmbH\n# Some text descriptions might be excerpted from (a) referenced\n# source(s), and are Copyright (C) by the respective right holder(s).\n#\n# SPDX-License-Identifier: GPL-2.0-or-later\n#\n# This program is free software; you can redistribute it and/or\n# modify it under the terms of the GNU General Public License\n# as published by the Free Software Foundation; either version 2\n# of the License, or (at your option) any later version.\n#\n# This program is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with this program; if not, write to the Free Software\n# Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n\nif(description)\n{\n  script_oid(\"1.3.6.1.4.1.25623.1.0.817231\");\n  script_version(\"2020-07-20T05:00:04+0000\");\n  script_cve_id(\"CVE-2020-1085\", \"CVE-2020-1249\", \"CVE-2020-1267\", \"CVE-2020-1333\",\n                \"CVE-2020-1350\", \"CVE-2020-1351\", \"CVE-2020-1354\", \"CVE-2020-1356\",\n                \"CVE-2020-1359\", \"CVE-2020-1360\", \"CVE-2020-1365\", \"CVE-2020-1368\",\n                \"CVE-2020-1371\", \"CVE-2020-1373\", \"CVE-2020-1374\", \"CVE-2020-1384\",\n                \"CVE-2020-1385\", \"CVE-2020-1389\", \"CVE-2020-1390\", \"CVE-2020-1396\",\n                \"CVE-2020-1397\", \"CVE-2020-1399\", \"CVE-2020-1400\", \"CVE-2020-1401\",\n                \"CVE-2020-1402\", \"CVE-2020-1403\", \"CVE-2020-1406\", \"CVE-2020-1407\",\n                \"CVE-2020-1408\", \"CVE-2020-1409\", \"CVE-2020-1410\", \"CVE-2020-1412\",\n                \"CVE-2020-1419\", \"CVE-2020-1421\", \"CVE-2020-1427\", \"CVE-2020-1428\",\n                \"CVE-2020-1430\", \"CVE-2020-1432\", \"CVE-2020-1435\", \"CVE-2020-1436\",\n                \"CVE-2020-1437\", \"CVE-2020-1438\", \"CVE-2020-1468\");\n  script_tag(name:\"cvss_base\", value:\"10.0\");\n  script_tag(name:\"cvss_base_vector\", value:\"AV:N/AC:M/Au:N/C:C/I:C/A:C\");\n  script_tag(name:\"last_modification\", value:\"2020-07-20 05:00:04 +0000 (Mon, 20 Jul 2020)\");\n  script_tag(name:\"creation_date\", value:\"2020-07-15 19:22:27 +0530 (Wed, 15 Jul 2020)\");\n  script_name(\"Microsoft Windows Multiple Vulnerabilities (KB4565541)\");\n\n  script_tag(name:\"summary\", value:\"This host is missing a critical security\n  update according to Microsoft KB4565541\");\n\n  script_tag(name:\"vuldetect\", value:\"Checks if a vulnerable version is present\n  on the target host.\");\n\n  script_tag(name:\"insight\", value:\"Multiple flaws exists due to,\n\n  - Windows Domain Name System servers fail to properly handle requests (SIGRed, CVE-2020-1350).\n\n  - DirectWrite fails to properly handle objects in memory.\n\n  - Windows Address Book (WAB) fails to properly processes vcard files.\n\n  - Windows Graphics Device Interface (GDI) fails to properly handle\n    objects in the memory.\n\n  - Windows Network Connections Service fails to handle objects in memory.\n  Please see the references for more information about the vulnerabilities.\");\n\n  script_tag(name:\"impact\", value:\"Successful exploitation will allow an attacker\n  to execute arbitrary code, elevate privilges, disclose sensitive information\n  and denial of service attacks.\");\n\n  script_tag(name:\"affected\", value:\"- Microsoft Windows 8.1 32-bit Systems\n\n  - Microsoft Windows 8.1 for x64-based Systems\n\n  - Microsoft Windows Server 2012 R2\");\n\n  script_tag(name:\"solution\", value:\"The vendor has released updates. Please see\n  the references for more information.\");\n\n  script_tag(name:\"solution_type\", value:\"VendorFix\");\n  script_tag(name:\"qod_type\", value:\"executable_version\");\n  script_xref(name:\"URL\", value:\"https://support.microsoft.com/en-us/help/4565541\");\n  script_category(ACT_GATHER_INFO);\n  script_copyright(\"Copyright (C) 2020 Greenbone Networks GmbH\");\n  script_family(\"Windows : Microsoft Bulletins\");\n  script_dependencies(\"smb_reg_service_pack.nasl\");\n  script_require_ports(139, 445);\n  script_mandatory_keys(\"SMB/WindowsVersion\");\n  exit(0);\n}\n\ninclude(\"smb_nt.inc\");\ninclude(\"secpod_reg.inc\");\ninclude(\"version_func.inc\");\ninclude(\"secpod_smb_func.inc\");\n\nif(hotfix_check_sp(win8_1:1, win8_1x64:1, win2012R2:1) <= 0)\n  exit(0);\n\ndllPath = smb_get_system32root();\nif(!dllPath)\n  exit(0);\n\nfileVer = fetch_file_version(sysPath:dllPath, file_name:\"Gdiplus.dll\");\nif(!fileVer)\n  exit(0);\n\nif(version_is_less(version:fileVer, test_version:\"6.3.9600.19756\")) {\n  report = report_fixed_ver(file_checked:dllPath + \"\\Gdiplus.dll\",\n                            file_version:fileVer, vulnerable_range:\"Less than 6.3.9600.19756\");\n  security_message(data:report);\n  exit(0);\n}\n\nexit(99);\n", "cvss": {"score": 10.0, "vector": "AV:N/AC:L/Au:N/C:C/I:C/A:C"}}, {"lastseen": "2020-07-21T19:51:39", "bulletinFamily": "scanner", "description": "This host is missing a critical security\n  update according to Microsoft KB4565511", "modified": "2020-07-20T00:00:00", "published": "2020-07-15T00:00:00", "id": "OPENVAS:1361412562310817226", "href": "http://plugins.openvas.org/nasl.php?oid=1361412562310817226", "title": "Microsoft Windows Multiple Vulnerabilities (KB4565511)", "type": "openvas", "sourceData": "# Copyright (C) 2020 Greenbone Networks GmbH\n# Some text descriptions might be excerpted from (a) referenced\n# source(s), and are Copyright (C) by the respective right holder(s).\n#\n# SPDX-License-Identifier: GPL-2.0-or-later\n#\n# This program is free software; you can redistribute it and/or\n# modify it under the terms of the GNU General Public License\n# as published by the Free Software Foundation; either version 2\n# of the License, or (at your option) any later version.\n#\n# This program is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with this program; if not, write to the Free Software\n# Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n\nif(description)\n{\n  script_oid(\"1.3.6.1.4.1.25623.1.0.817226\");\n  script_version(\"2020-07-20T05:00:04+0000\");\n  script_cve_id(\"CVE-2020-1085\", \"CVE-2020-1147\", \"CVE-2020-1249\", \"CVE-2020-1267\",\n                \"CVE-2020-1333\", \"CVE-2020-1336\", \"CVE-2020-1344\", \"CVE-2020-1350\",\n                \"CVE-2020-1351\", \"CVE-2020-1352\", \"CVE-2020-1353\", \"CVE-2020-1354\",\n                \"CVE-2020-1356\", \"CVE-2020-1357\", \"CVE-2020-1358\", \"CVE-2020-1359\",\n                \"CVE-2020-1360\", \"CVE-2020-1361\", \"CVE-2020-1362\", \"CVE-2020-1364\",\n                \"CVE-2020-1365\", \"CVE-2020-1368\", \"CVE-2020-1369\", \"CVE-2020-1370\",\n                \"CVE-2020-1371\", \"CVE-2020-1373\", \"CVE-2020-1374\", \"CVE-2020-1384\",\n                \"CVE-2020-1385\", \"CVE-2020-1388\", \"CVE-2020-1389\", \"CVE-2020-1390\",\n                \"CVE-2020-1393\", \"CVE-2020-1395\", \"CVE-2020-1396\", \"CVE-2020-1397\",\n                \"CVE-2020-1398\", \"CVE-2020-1399\", \"CVE-2020-1400\", \"CVE-2020-1401\",\n                \"CVE-2020-1402\", \"CVE-2020-1403\", \"CVE-2020-1404\", \"CVE-2020-1406\",\n                \"CVE-2020-1407\", \"CVE-2020-1408\", \"CVE-2020-1409\", \"CVE-2020-1410\",\n                \"CVE-2020-1411\", \"CVE-2020-1412\", \"CVE-2020-1413\", \"CVE-2020-1419\",\n                \"CVE-2020-1420\", \"CVE-2020-1421\", \"CVE-2020-1427\", \"CVE-2020-1428\",\n                \"CVE-2020-1429\", \"CVE-2020-1430\", \"CVE-2020-1432\", \"CVE-2020-1433\",\n                \"CVE-2020-1434\", \"CVE-2020-1435\", \"CVE-2020-1436\", \"CVE-2020-1437\",\n                \"CVE-2020-1438\", \"CVE-2020-1462\", \"CVE-2020-1463\", \"CVE-2020-1468\");\n  script_tag(name:\"cvss_base\", value:\"10.0\");\n  script_tag(name:\"cvss_base_vector\", value:\"AV:N/AC:M/Au:N/C:C/I:C/A:C\");\n  script_tag(name:\"last_modification\", value:\"2020-07-20 05:00:04 +0000 (Mon, 20 Jul 2020)\");\n  script_tag(name:\"creation_date\", value:\"2020-07-15 15:23:26 +0530 (Wed, 15 Jul 2020)\");\n  script_name(\"Microsoft Windows Multiple Vulnerabilities (KB4565511)\");\n\n  script_tag(name:\"summary\", value:\"This host is missing a critical security\n  update according to Microsoft KB4565511\");\n\n  script_tag(name:\"vuldetect\", value:\"Checks if a vulnerable version is present\n  on the target host.\");\n\n  script_tag(name:\"insight\", value:\"Multiple flaws exists due to,\n\n  - Windows Domain Name System servers fail to properly handle requests (SIGRed, CVE-2020-1350).\n\n  - Windows System Events Broker fails to properly handle file operations.\n\n  - Windows WalletService fails to properly handle objects in memory.\n\n  - Windows Runtime fails to properly handle objects in memory.\n\n  - Windows Jet Database Engine fails to properly handle objects in memory.\n\n  - Windows Network Connections Service fails to properly handle\n    objects in memory.\n\n  - SharedStream Library fails to handle objects in memory.\n\n  Please see the references for more information about the vulnerabilities.\");\n\n  script_tag(name:\"impact\", value:\"Successful exploitation will allow an attacker\n  to execute arbitrary code, elevate privilges, disclose sensitive information\n  and denial of service attacks.\");\n\n  script_tag(name:\"affected\", value:\"- Microsoft Windows 10 Version 1607 for 32-bit Systems\n\n  - Microsoft Windows 10 Version 1607 for x64-based Systems\n\n  - Microsoft Windows Server 2016\");\n\n  script_tag(name:\"solution\", value:\"The vendor has released updates. Please see\n  the references for more information.\");\n\n  script_tag(name:\"solution_type\", value:\"VendorFix\");\n  script_tag(name:\"qod_type\", value:\"executable_version\");\n  script_xref(name:\"URL\", value:\"https://support.microsoft.com/en-us/help/4565511\");\n  script_category(ACT_GATHER_INFO);\n  script_copyright(\"Copyright (C) 2020 Greenbone Networks GmbH\");\n  script_family(\"Windows : Microsoft Bulletins\");\n  script_dependencies(\"smb_reg_service_pack.nasl\");\n  script_require_ports(139, 445);\n  script_mandatory_keys(\"SMB/WindowsVersion\");\n  exit(0);\n}\n\ninclude(\"smb_nt.inc\");\ninclude(\"secpod_reg.inc\");\ninclude(\"version_func.inc\");\ninclude(\"secpod_smb_func.inc\");\n\nif(hotfix_check_sp(win10:1, win10x64:1, win2016:1) <= 0)\n  exit(0);\n\ndllPath = smb_get_system32root();\nif(!dllPath)\n  exit(0);\n\nfileVer = fetch_file_version(sysPath:dllPath, file_name:\"Gdiplus.dll\");\nif(!fileVer)\n  exit(0);\n\nif(version_in_range(version:fileVer, test_version:\"10.0.14393.0\", test_version2:\"10.0.14393.3807\")) {\n  report = report_fixed_ver(file_checked:dllPath + \"\\Gdiplus.dll\",\n                            file_version:fileVer, vulnerable_range:\"10.0.14393.0 - 10.0.14393.3807\");\n  security_message(data:report);\n  exit(0);\n}\n\nexit(99);\n", "cvss": {"score": 10.0, "vector": "AV:N/AC:L/Au:N/C:C/I:C/A:C"}}, {"lastseen": "2020-07-21T19:50:57", "bulletinFamily": "scanner", "description": "This host is missing a critical security\n  update according to Microsoft KB4565483", "modified": "2020-07-20T00:00:00", "published": "2020-07-15T00:00:00", "id": "OPENVAS:1361412562310817088", "href": "http://plugins.openvas.org/nasl.php?oid=1361412562310817088", "title": "Microsoft Windows Multiple Vulnerabilities (KB4565483)", "type": "openvas", "sourceData": "# Copyright (C) 2020 Greenbone Networks GmbH\n# Some text descriptions might be excerpted from (a) referenced\n# source(s), and are Copyright (C) by the respective right holder(s).\n#\n# SPDX-License-Identifier: GPL-2.0-or-later\n#\n# This program is free software; you can redistribute it and/or\n# modify it under the terms of the GNU General Public License\n# as published by the Free Software Foundation; either version 2\n# of the License, or (at your option) any later version.\n#\n# This program is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with this program; if not, write to the Free Software\n# Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n\nif(description)\n{\n  script_oid(\"1.3.6.1.4.1.25623.1.0.817088\");\n  script_version(\"2020-07-20T05:00:04+0000\");\n  script_cve_id(\"CVE-2020-1085\", \"CVE-2020-1249\", \"CVE-2020-1267\", \"CVE-2020-1330\",\n                \"CVE-2020-1333\", \"CVE-2020-1336\", \"CVE-2020-1344\", \"CVE-2020-1347\",\n                \"CVE-2020-1350\", \"CVE-2020-1351\", \"CVE-2020-1352\", \"CVE-2020-1353\",\n                \"CVE-2020-1354\", \"CVE-2020-1355\", \"CVE-2020-1356\", \"CVE-2020-1357\",\n                \"CVE-2020-1358\", \"CVE-2020-1359\", \"CVE-2020-1360\", \"CVE-2020-1361\",\n                \"CVE-2020-1362\", \"CVE-2020-1363\", \"CVE-2020-1364\", \"CVE-2020-1365\",\n                \"CVE-2020-1366\", \"CVE-2020-1367\", \"CVE-2020-1368\", \"CVE-2020-1369\",\n                \"CVE-2020-1370\", \"CVE-2020-1371\", \"CVE-2020-1372\", \"CVE-2020-1373\",\n                \"CVE-2020-1374\", \"CVE-2020-1375\", \"CVE-2020-1381\", \"CVE-2020-1382\",\n                \"CVE-2020-1384\", \"CVE-2020-1385\", \"CVE-2020-1386\", \"CVE-2020-1387\",\n                \"CVE-2020-1388\", \"CVE-2020-1389\", \"CVE-2020-1390\", \"CVE-2020-1391\",\n                \"CVE-2020-1392\", \"CVE-2020-1393\", \"CVE-2020-1394\", \"CVE-2020-1395\",\n                \"CVE-2020-1396\", \"CVE-2020-1397\", \"CVE-2020-1398\", \"CVE-2020-1399\",\n                \"CVE-2020-1400\", \"CVE-2020-1401\", \"CVE-2020-1402\", \"CVE-2020-1403\",\n                \"CVE-2020-1404\", \"CVE-2020-1405\", \"CVE-2020-1406\", \"CVE-2020-1407\",\n                \"CVE-2020-1408\", \"CVE-2020-1409\", \"CVE-2020-1410\", \"CVE-2020-1411\",\n                \"CVE-2020-1412\", \"CVE-2020-1413\", \"CVE-2020-1414\", \"CVE-2020-1415\",\n                \"CVE-2020-1418\", \"CVE-2020-1419\", \"CVE-2020-1420\", \"CVE-2020-1421\",\n                \"CVE-2020-1422\", \"CVE-2020-1424\", \"CVE-2020-1426\", \"CVE-2020-1427\",\n                \"CVE-2020-1428\", \"CVE-2020-1429\", \"CVE-2020-1430\", \"CVE-2020-1431\",\n                \"CVE-2020-1432\", \"CVE-2020-1433\", \"CVE-2020-1434\", \"CVE-2020-1435\",\n                \"CVE-2020-1436\", \"CVE-2020-1437\", \"CVE-2020-1438\", \"CVE-2020-1462\",\n                \"CVE-2020-1463\", \"CVE-2020-1468\");\n  script_tag(name:\"cvss_base\", value:\"10.0\");\n  script_tag(name:\"cvss_base_vector\", value:\"AV:N/AC:M/Au:N/C:C/I:C/A:C\");\n  script_tag(name:\"last_modification\", value:\"2020-07-20 05:00:04 +0000 (Mon, 20 Jul 2020)\");\n  script_tag(name:\"creation_date\", value:\"2020-07-15 14:47:24 +0530 (Wed, 15 Jul 2020)\");\n  script_name(\"Microsoft Windows Multiple Vulnerabilities (KB4565483)\");\n\n  script_tag(name:\"summary\", value:\"This host is missing a critical security\n  update according to Microsoft KB4565483\");\n\n  script_tag(name:\"vuldetect\", value:\"Checks if a vulnerable version is present\n  on the target host.\");\n\n  script_tag(name:\"insight\", value:\"Multiple flaws exists due to,\n\n  - Windows Domain Name System servers fail to properly handle requests (SIGRed, CVE-2020-1350).\n\n  - Windows System Events Broker fails to properly handle file operations.\n\n  - Windows WalletService fails to properly handle objects in memory.\n\n  - Windows Mobile Device Management (MDM) Diagnostics fails to\n    properly handle objects in memory.\n\n  - Windows Jet Database Engine fails to properly handle objects in memory.\n\n  - Windows Network Connections Service fails to properly handle\n    objects in memory.\n\n  - SharedStream Library fails to handle objects in memory.\n\n  Please see the references for more information about the vulnerabilities.\");\n\n  script_tag(name:\"impact\", value:\"Successful exploitation will allow an attacker\n  to execute arbitrary code, elevate privilges, disclose sensitive information\n  and denial of service attacks.\");\n\n  script_tag(name:\"affected\", value:\"- Microsoft Windows 10 Version 1903 for 32-bit Systems\n\n  - Microsoft Windows 10 Version 1909 for 32-bit Systems\n\n  - Microsoft Windows 10 Version 1903 for x64-based Systems\n\n  - Microsoft Windows 10 Version 1909 for x64-based Systems\");\n\n  script_tag(name:\"solution\", value:\"The vendor has released updates. Please see\n  the references for more information.\");\n\n  script_tag(name:\"solution_type\", value:\"VendorFix\");\n  script_tag(name:\"qod_type\", value:\"executable_version\");\n  script_xref(name:\"URL\", value:\"https://support.microsoft.com/en-us/help/4565483\");\n  script_category(ACT_GATHER_INFO);\n  script_copyright(\"Copyright (C) 2020 Greenbone Networks GmbH\");\n  script_family(\"Windows : Microsoft Bulletins\");\n  script_dependencies(\"smb_reg_service_pack.nasl\");\n  script_require_ports(139, 445);\n  script_mandatory_keys(\"SMB/WindowsVersion\");\n  exit(0);\n}\n\ninclude(\"smb_nt.inc\");\ninclude(\"secpod_reg.inc\");\ninclude(\"version_func.inc\");\ninclude(\"secpod_smb_func.inc\");\n\nif(hotfix_check_sp(win10:1, win10x64:1) <= 0)\n  exit(0);\n\ndllPath = smb_get_system32root();\nif(!dllPath)\n  exit(0);\n\nfileVer = fetch_file_version(sysPath:dllPath, file_name:\"Gdiplus.dll\");\nif(!fileVer)\n  exit(0);\n\nif(version_in_range(version:fileVer, test_version:\"10.0.18362.0\", test_version2:\"10.0.18362.959\")) {\n  report = report_fixed_ver(file_checked:dllPath + \"\\Gdiplus.dll\",\n                            file_version:fileVer, vulnerable_range:\"10.0.18362.0 - 10.0.18362.959\");\n  security_message(data:report);\n  exit(0);\n}\n\nexit(99);\n", "cvss": {"score": 10.0, "vector": "AV:N/AC:L/Au:N/C:C/I:C/A:C"}}, {"lastseen": "2020-07-21T19:51:32", "bulletinFamily": "scanner", "description": "This host is missing a critical security\n  update according to Microsoft KB4565503", "modified": "2020-07-20T00:00:00", "published": "2020-07-15T00:00:00", "id": "OPENVAS:1361412562310817224", "href": "http://plugins.openvas.org/nasl.php?oid=1361412562310817224", "title": "Microsoft Windows Multiple Vulnerabilities (KB4565503)", "type": "openvas", "sourceData": "# Copyright (C) 2020 Greenbone Networks GmbH\n# Some text descriptions might be excerpted from (a) referenced\n# source(s), and are Copyright (C) by the respective right holder(s).\n#\n# SPDX-License-Identifier: GPL-2.0-or-later\n#\n# This program is free software; you can redistribute it and/or\n# modify it under the terms of the GNU General Public License\n# as published by the Free Software Foundation; either version 2\n# of the License, or (at your option) any later version.\n#\n# This program is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with this program; if not, write to the Free Software\n# Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n\nif(description)\n{\n  script_oid(\"1.3.6.1.4.1.25623.1.0.817224\");\n  script_version(\"2020-07-20T05:00:04+0000\");\n  script_cve_id(\"CVE-2019-1469\", \"CVE-2020-1085\", \"CVE-2020-1249\", \"CVE-2020-1267\",\n                \"CVE-2020-1330\", \"CVE-2020-1333\", \"CVE-2020-1336\", \"CVE-2020-1344\",\n                \"CVE-2020-1347\", \"CVE-2020-1350\", \"CVE-2020-1351\", \"CVE-2020-1352\",\n                \"CVE-2020-1353\", \"CVE-2020-1354\", \"CVE-2020-1355\", \"CVE-2020-1356\",\n                \"CVE-2020-1357\", \"CVE-2020-1358\", \"CVE-2020-1359\", \"CVE-2020-1360\",\n                \"CVE-2020-1361\", \"CVE-2020-1362\", \"CVE-2020-1363\", \"CVE-2020-1364\",\n                \"CVE-2020-1365\", \"CVE-2020-1366\", \"CVE-2020-1367\", \"CVE-2020-1368\",\n                \"CVE-2020-1369\", \"CVE-2020-1370\", \"CVE-2020-1371\", \"CVE-2020-1372\",\n                \"CVE-2020-1373\", \"CVE-2020-1374\", \"CVE-2020-1375\", \"CVE-2020-1381\",\n                \"CVE-2020-1382\", \"CVE-2020-1384\", \"CVE-2020-1385\", \"CVE-2020-1386\",\n                \"CVE-2020-1387\", \"CVE-2020-1388\", \"CVE-2020-1389\", \"CVE-2020-1390\",\n                \"CVE-2020-1391\", \"CVE-2020-1392\", \"CVE-2020-1393\", \"CVE-2020-1394\",\n                \"CVE-2020-1395\", \"CVE-2020-1396\", \"CVE-2020-1397\", \"CVE-2020-1398\",\n                \"CVE-2020-1399\", \"CVE-2020-1400\", \"CVE-2020-1401\", \"CVE-2020-1402\",\n                \"CVE-2020-1403\", \"CVE-2020-1404\", \"CVE-2020-1405\", \"CVE-2020-1406\",\n                \"CVE-2020-1407\", \"CVE-2020-1408\", \"CVE-2020-1409\", \"CVE-2020-1410\",\n                \"CVE-2020-1411\", \"CVE-2020-1412\", \"CVE-2020-1413\", \"CVE-2020-1414\",\n                \"CVE-2020-1415\", \"CVE-2020-1418\", \"CVE-2020-1419\", \"CVE-2020-1420\",\n                \"CVE-2020-1421\", \"CVE-2020-1422\", \"CVE-2020-1423\", \"CVE-2020-1424\",\n                \"CVE-2020-1426\", \"CVE-2020-1427\", \"CVE-2020-1428\", \"CVE-2020-1429\",\n                \"CVE-2020-1430\", \"CVE-2020-1431\", \"CVE-2020-1432\", \"CVE-2020-1433\",\n                \"CVE-2020-1434\", \"CVE-2020-1435\", \"CVE-2020-1436\", \"CVE-2020-1437\",\n                \"CVE-2020-1438\", \"CVE-2020-1462\", \"CVE-2020-1463\", \"CVE-2020-1468\");\n  script_tag(name:\"cvss_base\", value:\"9.3\");\n  script_tag(name:\"cvss_base_vector\", value:\"AV:N/AC:M/Au:N/C:C/I:C/A:C\");\n  script_tag(name:\"last_modification\", value:\"2020-07-20 05:00:04 +0000 (Mon, 20 Jul 2020)\");\n  script_tag(name:\"creation_date\", value:\"2020-07-15 12:33:34 +0530 (Wed, 15 Jul 2020)\");\n  script_name(\"Microsoft Windows Multiple Vulnerabilities (KB4565503)\");\n\n  script_tag(name:\"summary\", value:\"This host is missing a critical security\n  update according to Microsoft KB4565503\");\n\n  script_tag(name:\"vuldetect\", value:\"Checks if a vulnerable version is present\n  on the target host.\");\n\n  script_tag(name:\"insight\", value:\"Multiple flaws exists due to,\n\n  - Windows Domain Name System servers fail to properly handle requests (SIGRed, CVE-2020-1350).\n\n  - Windows System Events Broker fails to properly handle file operations.\n\n  - Windows WalletService fails to properly handle objects in memory.\n\n  - Windows Mobile Device Management (MDM) Diagnostics fails to\n    properly handle objects in memory.\n\n  - Windows Jet Database Engine fails to properly handle objects in memory.\n\n  - Windows Network Connections Service fails to properly handle\n    objects in memory.\n\n  - SharedStream Library fails to handle objects in memory.\n  Please see the references for more information about the vulnerabilities.\");\n\n  script_tag(name:\"impact\", value:\"Successful exploitation will allow an attacker\n  to execute arbitrary code, elevate privilges, disclose sensitive information\n  and denial of service attacks.\");\n\n  script_tag(name:\"affected\", value:\"- Microsoft Windows 10 Version 2004 for 32-bit Systems\n\n  - Microsoft Windows 10 Version 2004 for x64-based Systems\");\n\n  script_tag(name:\"solution\", value:\"The vendor has released updates. Please see\n  the references for more information.\");\n\n  script_tag(name:\"solution_type\", value:\"VendorFix\");\n  script_tag(name:\"qod_type\", value:\"executable_version\");\n  script_xref(name:\"URL\", value:\"https://support.microsoft.com/en-us/help/4565503\");\n  script_category(ACT_GATHER_INFO);\n  script_copyright(\"Copyright (C) 2020 Greenbone Networks GmbH\");\n  script_family(\"Windows : Microsoft Bulletins\");\n  script_dependencies(\"smb_reg_service_pack.nasl\");\n  script_require_ports(139, 445);\n  script_mandatory_keys(\"SMB/WindowsVersion\");\n  exit(0);\n}\n\ninclude(\"smb_nt.inc\");\ninclude(\"secpod_reg.inc\");\ninclude(\"version_func.inc\");\ninclude(\"secpod_smb_func.inc\");\n\nif(hotfix_check_sp(win10:1, win10x64:1) <= 0)\n  exit(0);\n\ndllPath = smb_get_system32root();\nif(!dllPath)\n  exit(0);\n\nfileVer = fetch_file_version(sysPath:dllPath, file_name:\"Gdiplus.dll\");\nif(!fileVer)\n  exit(0);\n\nif(version_in_range(version:fileVer, test_version:\"10.0.19041.0\", test_version2:\"10.0.19041.387\")) {\n  report = report_fixed_ver(file_checked:dllPath + \"\\Gdiplus.dll\",\n                            file_version:fileVer, vulnerable_range:\"10.0.19041.0 - 10.0.19041.387\");\n  security_message(data:report);\n  exit(0);\n}\n\nexit(99);\n", "cvss": {"score": 10.0, "vector": "AV:N/AC:L/Au:N/C:C/I:C/A:C"}}, {"lastseen": "2020-07-21T19:51:36", "bulletinFamily": "scanner", "description": "This host is missing a critical security\n  update according to Microsoft KB4558998", "modified": "2020-07-20T00:00:00", "published": "2020-07-15T00:00:00", "id": "OPENVAS:1361412562310817228", "href": "http://plugins.openvas.org/nasl.php?oid=1361412562310817228", "title": "Microsoft Windows Multiple Vulnerabilities (KB4558998)", "type": "openvas", "sourceData": "# Copyright (C) 2020 Greenbone Networks GmbH\n# Some text descriptions might be excerpted from (a) referenced\n# source(s), and are Copyright (C) by the respective right holder(s).\n#\n# SPDX-License-Identifier: GPL-2.0-or-later\n#\n# This program is free software; you can redistribute it and/or\n# modify it under the terms of the GNU General Public License\n# as published by the Free Software Foundation; either version 2\n# of the License, or (at your option) any later version.\n#\n# This program is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with this program; if not, write to the Free Software\n# Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n\nif(description)\n{\n  script_oid(\"1.3.6.1.4.1.25623.1.0.817228\");\n  script_version(\"2020-07-20T05:00:04+0000\");\n  script_cve_id(\"CVE-2020-1085\", \"CVE-2020-1249\", \"CVE-2020-1267\", \"CVE-2020-1330\",\n                \"CVE-2020-1333\", \"CVE-2020-1336\", \"CVE-2020-1344\", \"CVE-2020-1347\",\n                \"CVE-2020-1350\", \"CVE-2020-1351\", \"CVE-2020-1352\", \"CVE-2020-1353\",\n                \"CVE-2020-1354\", \"CVE-2020-1356\", \"CVE-2020-1357\", \"CVE-2020-1358\",\n                \"CVE-2020-1359\", \"CVE-2020-1360\", \"CVE-2020-1361\", \"CVE-2020-1362\",\n                \"CVE-2020-1363\", \"CVE-2020-1364\", \"CVE-2020-1365\", \"CVE-2020-1366\",\n                \"CVE-2020-1367\", \"CVE-2020-1368\", \"CVE-2020-1369\", \"CVE-2020-1370\",\n                \"CVE-2020-1371\", \"CVE-2020-1372\", \"CVE-2020-1373\", \"CVE-2020-1374\",\n                \"CVE-2020-1375\", \"CVE-2020-1384\", \"CVE-2020-1385\", \"CVE-2020-1386\",\n                \"CVE-2020-1387\", \"CVE-2020-1388\", \"CVE-2020-1389\", \"CVE-2020-1390\",\n                \"CVE-2020-1392\", \"CVE-2020-1393\", \"CVE-2020-1394\", \"CVE-2020-1395\",\n                \"CVE-2020-1396\", \"CVE-2020-1397\", \"CVE-2020-1398\", \"CVE-2020-1399\",\n                \"CVE-2020-1400\", \"CVE-2020-1401\", \"CVE-2020-1402\", \"CVE-2020-1403\",\n                \"CVE-2020-1404\", \"CVE-2020-1405\", \"CVE-2020-1406\", \"CVE-2020-1407\",\n                \"CVE-2020-1408\", \"CVE-2020-1409\", \"CVE-2020-1410\", \"CVE-2020-1411\",\n                \"CVE-2020-1412\", \"CVE-2020-1413\", \"CVE-2020-1414\", \"CVE-2020-1415\",\n                \"CVE-2020-1418\", \"CVE-2020-1419\", \"CVE-2020-1420\", \"CVE-2020-1421\",\n                \"CVE-2020-1422\", \"CVE-2020-1424\", \"CVE-2020-1426\", \"CVE-2020-1427\",\n                \"CVE-2020-1428\", \"CVE-2020-1429\", \"CVE-2020-1430\", \"CVE-2020-1431\",\n                \"CVE-2020-1432\", \"CVE-2020-1433\", \"CVE-2020-1434\", \"CVE-2020-1435\",\n                \"CVE-2020-1436\", \"CVE-2020-1437\", \"CVE-2020-1438\", \"CVE-2020-1462\",\n                \"CVE-2020-1463\", \"CVE-2020-1468\");\n  script_tag(name:\"cvss_base\", value:\"10.0\");\n  script_tag(name:\"cvss_base_vector\", value:\"AV:N/AC:M/Au:N/C:C/I:C/A:C\");\n  script_tag(name:\"last_modification\", value:\"2020-07-20 05:00:04 +0000 (Mon, 20 Jul 2020)\");\n  script_tag(name:\"creation_date\", value:\"2020-07-15 17:15:21 +0530 (Wed, 15 Jul 2020)\");\n  script_name(\"Microsoft Windows Multiple Vulnerabilities (KB4558998)\");\n\n  script_tag(name:\"summary\", value:\"This host is missing a critical security\n  update according to Microsoft KB4558998\");\n\n  script_tag(name:\"vuldetect\", value:\"Checks if a vulnerable version is present\n  on the target host.\");\n\n  script_tag(name:\"insight\", value:\"Multiple flaws exists due to,\n\n  - Windows Domain Name System servers fail to properly handle requests (SIGRed, CVE-2020-1350).\n\n  - Windows System Events Broker fails to properly handle file operations.\n\n  - Windows WalletService fails to properly handle objects in memory.\n\n  - Windows Mobile Device Management (MDM) Diagnostics fails to\n    properly handle objects in memory.\n\n  - Windows Jet Database Engine fails to properly handle objects in memory.\n\n  - Windows Network Connections Service fails to properly handle\n    objects in memory.\n\n  - SharedStream Library fails to handle objects in memory.\n\n  Please see the references for more information about the vulnerabilities.\");\n\n  script_tag(name:\"impact\", value:\"Successful exploitation will allow an attacker\n  to execute arbitrary code, elevate privilges, disclose sensitive information\n  and denial of service attacks.\");\n\n  script_tag(name:\"affected\", value:\"- Microsoft Windows 10 Version 1809 for 32-bit Systems\n\n  - Microsoft Windows 10 Version 1809 for x64-based Systems\n\n  - Microsoft Windows Server 2019\");\n\n  script_tag(name:\"solution\", value:\"The vendor has released updates. Please see\n  the references for more information.\");\n\n  script_tag(name:\"solution_type\", value:\"VendorFix\");\n  script_tag(name:\"qod_type\", value:\"executable_version\");\n  script_xref(name:\"URL\", value:\"https://support.microsoft.com/en-us/help/4558998\");\n  script_category(ACT_GATHER_INFO);\n  script_copyright(\"Copyright (C) 2020 Greenbone Networks GmbH\");\n  script_family(\"Windows : Microsoft Bulletins\");\n  script_dependencies(\"smb_reg_service_pack.nasl\");\n  script_require_ports(139, 445);\n  script_mandatory_keys(\"SMB/WindowsVersion\");\n  exit(0);\n}\n\ninclude(\"smb_nt.inc\");\ninclude(\"secpod_reg.inc\");\ninclude(\"version_func.inc\");\ninclude(\"secpod_smb_func.inc\");\n\nif(hotfix_check_sp(win10:1, win10x64:1, win2019:1) <= 0){\n  exit(0);\n}\n\ndllPath = smb_get_system32root();\nif(!dllPath)\n  exit(0);\n\nfileVer = fetch_file_version(sysPath:dllPath, file_name:\"Gdiplus.dll\");\nif(!fileVer)\n  exit(0);\n\nif(version_in_range(version:fileVer, test_version:\"10.0.17763.0\", test_version2:\"10.0.17763.1338\")) {\n  report = report_fixed_ver(file_checked:dllPath + \"\\Gdiplus.dll\",\n                            file_version:fileVer, vulnerable_range:\"10.0.17763.0 - 10.0.17763.1338\");\n  security_message(data:report);\n  exit(0);\n}\n\nexit(99);\n", "cvss": {"score": 10.0, "vector": "AV:N/AC:L/Au:N/C:C/I:C/A:C"}}]}}}, "error": false, "status": "ID was found on vulners.com portal", "not_found_error": false}